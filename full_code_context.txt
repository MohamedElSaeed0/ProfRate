================
File: AuthController.cs
================
using Microsoft.AspNetCore.Mvc;
using ProfRate.DTOs;
using ProfRate.Services;

namespace ProfRate.Controllers
{
    [Route("api/auth")]
    [ApiController]
    public class AuthController : ControllerBase
    {
        private readonly AuthService _authService;

        public AuthController(AuthService authService)
        {
            _authService = authService;
        }

        // POST: api/auth/login
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        [HttpPost]
        [Route("login")]
        [Microsoft.AspNetCore.RateLimiting.EnableRateLimiting("login")]
        public async Task<IActionResult> Login([FromBody] LoginDTO loginDto)
        {
            var result = await _authService.Login(loginDto);

            if (result.Success)
            {
                return Ok(result);
            }

            return Unauthorized(result);
        }
    }
}



================
File: EvaluationController.cs
================
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;
using ProfRate.DTOs;
using ProfRate.Services;

namespace ProfRate.Controllers
{
    [Route("api/evaluations")]
    [ApiController]
    public class EvaluationController : ControllerBase
    {
        private readonly EvaluationService _evaluationService;

        public EvaluationController(EvaluationService evaluationService)
        {
            _evaluationService = evaluationService;
        }

        // GET: api/evaluations/GetAll
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
        [HttpGet]
        [Route("GetAll")]
        public async Task<IActionResult> GetAllEvaluations()
        {
            var evaluations = await _evaluationService.GetAllEvaluations();
            return Ok(evaluations);
        }

        // GET: api/evaluations/GetByLecturer/5
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù…Ø­Ø§Ø¶Ø± Ù…Ø¹ÙŠÙ†
        [HttpGet]
        [Route("GetByLecturer/{lecturerId}")]
        public async Task<IActionResult> GetEvaluationsByLecturer(int lecturerId)
        {
            var evaluations = await _evaluationService.GetEvaluationsByLecturer(lecturerId);
            return Ok(evaluations);
        }

        // GET: api/evaluations/GetReport
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
        [HttpGet]
        [Route("GetReport")]
        public async Task<IActionResult> GetEvaluationReport()
        {
            var report = await _evaluationService.GetEvaluationReport();
            return Ok(report);
        }

        // POST: api/evaluations/Add
        // Ø¥Ø¶Ø§ÙØ© ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯
        [HttpPost]
        [Route("Add")]
        [Authorize(Roles = "Student")] // Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙ‚Ø· Ù‡Ù… Ù…Ù† ÙŠÙ‚ÙŠÙ…ÙˆÙ†
        public async Task<IActionResult> AddEvaluation([FromBody] EvaluationDTO dto)
        {
            try
            {
                var evaluation = await _evaluationService.AddEvaluation(dto);
                return Ok(new { message = "ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­", evaluation });
            }
            catch (InvalidOperationException ex)
            {
                return BadRequest(new { message = ex.Message });
            }
        }

        // POST: api/evaluations/Reset
        // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª (Ù„Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·)
        [HttpPost]
        [Route("Reset")]
        [Authorize(Roles = "Admin")] // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·
        public async Task<IActionResult> ResetEvaluations()
        {
            var result = await _evaluationService.ResetEvaluations();
            return Ok(new { message = result ? "ØªÙ…Øª Ø£Ø±Ø´ÙØ© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ÙˆØ¨Ø¯Ø¡ Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ù†Ø¬Ø§Ø­" : "Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù†Ø´Ø·Ø© Ù„Ù„Ø£Ø±Ø´ÙØ©" });
        }
    }
}



================
File: LecturerController.cs
================
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;
using ProfRate.DTOs;
using ProfRate.Services;

namespace ProfRate.Controllers
{
    [Route("api/lecturers")]
    [ApiController]
    public class LecturerController : ControllerBase
    {
        private readonly LecturerService _lecturerService;

        public LecturerController(LecturerService lecturerService)
        {
            _lecturerService = lecturerService;
        }

        // GET: api/lecturers/GetAll
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†
        [HttpGet]
        [Route("GetAll")]
        public async Task<IActionResult> GetAllLecturers()
        {
            var lecturers = await _lecturerService.GetAllLecturers();
            return Ok(lecturers);
        }

        // GET: api/lecturers/Search?query=...
        [HttpGet]
        [Route("Search")]
        public async Task<IActionResult> Search([FromQuery] string query)
        {
            var lecturers = await _lecturerService.Search(query);
            return Ok(lecturers);
        }

        // GET: api/lecturers/GetById/5
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø­Ø§Ø¶Ø± Ø¨Ø§Ù„Ù€ ID
        [HttpGet]
        [Route("GetById/{id}")]
        public async Task<IActionResult> GetLecturerById(int id)
        {
            var lecturer = await _lecturerService.GetLecturerById(id);
            if (lecturer == null)
            {
                return NotFound(new { message = "Ø§Ù„Ù…Ø­Ø§Ø¶Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(lecturer);
        }

        // POST: api/lecturers/Add
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø§Ø¶Ø± Ø¬Ø¯ÙŠØ¯
        [HttpPost]
        [Route("Add")]
        public async Task<IActionResult> AddLecturer([FromBody] LecturerDTO dto)
        {
            var lecturer = await _lecturerService.AddLecturer(dto);
            return Ok(new { message = "ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ù†Ø¬Ø§Ø­", lecturer });
        }

        // PUT: api/lecturers/Update/5
        // ØªØ¹Ø¯ÙŠÙ„ Ù…Ø­Ø§Ø¶Ø±
        [HttpPut]
        [Route("Update/{id}")]
        public async Task<IActionResult> UpdateLecturer(int id, [FromBody] LecturerDTO dto)
        {
            var lecturer = await _lecturerService.UpdateLecturer(id, dto);
            if (lecturer == null)
            {
                return NotFound(new { message = "Ø§Ù„Ù…Ø­Ø§Ø¶Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(new { message = "ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ù†Ø¬Ø§Ø­", lecturer });
        }

        // DELETE: api/lecturers/Delete/5
        // Ø­Ø°Ù Ù…Ø­Ø§Ø¶Ø±
        [HttpDelete]
        [Route("Delete/{id}")]
        public async Task<IActionResult> DeleteLecturer(int id)
        {
            var result = await _lecturerService.DeleteLecturer(id);
            if (!result)
            {
                return NotFound(new { message = "Ø§Ù„Ù…Ø­Ø§Ø¶Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(new { message = "ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ù†Ø¬Ø§Ø­" });
        }
    }
}



================
File: LecturerSubjectController.cs
================
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using ProfRate.Data;
using ProfRate.Entities;

namespace ProfRate.Controllers
{
    [Route("api/lecturersubjects")]
    [ApiController]
    public class LecturerSubjectController : ControllerBase
    {
        private readonly ProfRate.Services.LecturerSubjectService _service;

        public LecturerSubjectController(ProfRate.Services.LecturerSubjectService service)
        {
            _service = service;
        }

        // GET: api/lecturersubjects/GetAll
        [HttpGet]
        [Route("GetAll")]
        public async Task<IActionResult> GetAll()
        {
            var list = await _service.GetAll();
            return Ok(list);
        }

        // GET: api/lecturersubjects/GetByLecturer/5
        [HttpGet]
        [Route("GetByLecturer/{lecturerId}")]
        public async Task<IActionResult> GetByLecturer(int lecturerId)
        {
            var list = await _service.GetByLecturer(lecturerId);
            return Ok(list);
        }

        // GET: api/lecturersubjects/GetBySubject/5
        [HttpGet]
        [Route("GetBySubject/{subjectId}")]
        public async Task<IActionResult> GetBySubject(int subjectId)
        {
            var list = await _service.GetBySubject(subjectId);
            return Ok(list);
        }

        // POST: api/lecturersubjects/Add
        [HttpPost]
        [Route("Add")]
        public async Task<IActionResult> Add([FromBody] ProfRate.DTOs.LecturerSubjectDTO model)
        {
            var result = await _service.AddLecturerSubject(model);
            if (!result.Success)
            {
                return BadRequest(new { message = result.Message });
            }
            return Ok(new { message = result.Message });
        }

        // PUT: api/lecturersubjects/Update/5
        [HttpPut]
        [Route("Update/{id}")]
        public async Task<IActionResult> Update(int id, [FromBody] ProfRate.DTOs.LecturerSubjectDTO model)
        {
            var result = await _service.UpdateLecturerSubject(id, model);
            if (!result.Success)
            {
                return BadRequest(new { message = result.Message });
            }
            return Ok(new { message = result.Message });
        }

        // DELETE: api/lecturersubjects/Delete/5
        [HttpDelete]
        [Route("Delete/{id}")]
        public async Task<IActionResult> Delete(int id)
        {
            var success = await _service.DeleteLecturerSubject(id);
            if (!success)
            {
                return NotFound(new { message = "ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(new { message = "ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­" });
        }
    }
}



================
File: QuestionController.cs
================
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;
using ProfRate.DTOs;
using ProfRate.Services;

namespace ProfRate.Controllers
{
    [Route("api/questions")]
    [ApiController]
    public class QuestionController : ControllerBase
    {
        private readonly QuestionService _questionService;

        public QuestionController(QuestionService questionService)
        {
            _questionService = questionService;
        }

        // GET: api/questions/GetAll
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
        [HttpGet]
        [Route("GetAll")]
        public async Task<IActionResult> GetAllQuestions()
        {
            var questions = await _questionService.GetAllQuestions();
            return Ok(questions);
        }

        // GET: api/questions/GetById/5
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ø¤Ø§Ù„ Ø¨Ø§Ù„Ù€ ID
        [HttpGet]
        [Route("GetById/{id}")]
        public async Task<IActionResult> GetQuestionById(int id)
        {
            var question = await _questionService.GetQuestionById(id);
            if (question == null)
            {
                return NotFound(new { message = "Ø§Ù„Ø³Ø¤Ø§Ù„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(question);
        }

        // POST: api/questions/Add
        // Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯
        [HttpPost]
        [Route("Add")]
        public async Task<IActionResult> AddQuestion([FromBody] QuestionDTO dto)
        {
            var question = await _questionService.AddQuestion(dto);
            return Ok(new { message = "ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­", question });
        }

        // PUT: api/questions/Update/5
        // ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¤Ø§Ù„
        [HttpPut]
        [Route("Update/{id}")]
        public async Task<IActionResult> UpdateQuestion(int id, [FromBody] QuestionDTO dto)
        {
            var question = await _questionService.UpdateQuestion(id, dto);
            if (question == null)
            {
                return NotFound(new { message = "Ø§Ù„Ø³Ø¤Ø§Ù„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(new { message = "ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­", question });
        }

        // DELETE: api/questions/Delete/5
        // Ø­Ø°Ù Ø³Ø¤Ø§Ù„
        [HttpDelete]
        [Route("Delete/{id}")]
        public async Task<IActionResult> DeleteQuestion(int id)
        {
            var result = await _questionService.DeleteQuestion(id);
            if (!result)
            {
                return NotFound(new { message = "Ø§Ù„Ø³Ø¤Ø§Ù„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(new { message = "ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­" });
        }
    }
}



================
File: StudentController.cs
================
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;
using ProfRate.DTOs;
using ProfRate.Services;

namespace ProfRate.Controllers
{
    [Route("api/students")]
    [ApiController]
    public class StudentController : ControllerBase
    {
        private readonly StudentService _studentService;

        public StudentController(StudentService studentService)
        {
            _studentService = studentService;
        }

        // GET: api/students
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨
        // GET: api/students
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨
        [HttpGet]
        [Route("GetAll")]
        public async Task<IActionResult> GetAllStudents([FromQuery] int page = 1, [FromQuery] int pageSize = 20)
        {
            if (page < 1) page = 1;
            if (pageSize < 1 || pageSize > 100) pageSize = 20;

            var result = await _studentService.GetAllStudents(page, pageSize);
            return Ok(result);
        }

        // GET: api/students/Search?query=...
        [HttpGet]
        [Route("Search")]
        public async Task<IActionResult> Search([FromQuery] string query)
        {
            var students = await _studentService.Search(query);
            return Ok(students);
        }

        // GET: api/students/GetById/5
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ù€ ID
        [HttpGet]
        [Route("GetById/{id}")]
        public async Task<IActionResult> GetStudentById(int id)
        {
            var student = await _studentService.GetStudentById(id);
            if (student == null)
            {
                return NotFound(new { message = "Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(student);
        }

        // POST: api/students/Add
        // Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
        [HttpPost]
        [Route("Add")]
        public async Task<IActionResult> AddStudent([FromBody] StudentDTO dto)
        {
            var student = await _studentService.AddStudent(dto);
            return Ok(new { message = "ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­", student });
        }

        // PUT: api/students/Update/5
        // ØªØ¹Ø¯ÙŠÙ„ Ø·Ø§Ù„Ø¨
        [HttpPut]
        [Route("Update/{id}")]
        public async Task<IActionResult> UpdateStudent(int id, [FromBody] StudentDTO dto)
        {
            var student = await _studentService.UpdateStudent(id, dto);
            if (student == null)
            {
                return NotFound(new { message = "Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(new { message = "ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­", student });
        }

        // DELETE: api/students/Delete/5
        // Ø­Ø°Ù Ø·Ø§Ù„Ø¨
        [HttpDelete]
        [Route("Delete/{id}")]
        public async Task<IActionResult> DeleteStudent(int id)
        {
            var result = await _studentService.DeleteStudent(id);
            if (!result)
            {
                return NotFound(new { message = "Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(new { message = "ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­" });
        }
    }
}



================
File: StudentSubjectController.cs
================
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using ProfRate.Data;
using ProfRate.Entities;

namespace ProfRate.Controllers
{
    [Route("api/studentsubjects")]
    [ApiController]
    public class StudentSubjectController : ControllerBase
    {
        private readonly ProfRate.Services.StudentSubjectService _service;

        public StudentSubjectController(ProfRate.Services.StudentSubjectService service)
        {
            _service = service;
        }

        // GET: api/studentsubjects/GetAll
        [HttpGet]
        [Route("GetAll")]
        public async Task<IActionResult> GetAll()
        {
            var list = await _service.GetAll();
            return Ok(list);
        }

        // GET: api/studentsubjects/GetByStudent/5
        [HttpGet]
        [Route("GetByStudent/{studentId}")]
        public async Task<IActionResult> GetByStudent(int studentId)
        {
            var list = await _service.GetByStudent(studentId);
            return Ok(list);
        }

        // POST: api/studentsubjects/Add
        [HttpPost]
        [Route("Add")]
        public async Task<IActionResult> Add([FromBody] ProfRate.DTOs.StudentSubjectDTO model)
        {
            var result = await _service.AddStudentSubject(model);
            if (!result.Success)
            {
                return BadRequest(new { message = result.Message });
            }
            return Ok(new { message = result.Message });
        }

        // PUT: api/studentsubjects/Update/5
        [HttpPut]
        [Route("Update/{id}")]
        public async Task<IActionResult> Update(int id, [FromBody] ProfRate.DTOs.StudentSubjectDTO model)
        {
            var result = await _service.UpdateStudentSubject(id, model);
            if (!result.Success)
            {
                return BadRequest(new { message = result.Message });
            }
            return Ok(new { message = result.Message });
        }

        // DELETE: api/studentsubjects/Delete/5
        [HttpDelete]
        [Route("Delete/{id}")]
        public async Task<IActionResult> Delete(int id)
        {
            var success = await _service.DeleteStudentSubject(id);
            if (!success)
            {
                return NotFound(new { message = "ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯" });
            }
            return Ok(new { message = "ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­" });
        }
    }
}



================
File: SubjectController.cs
================
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;
using ProfRate.DTOs;
using ProfRate.Services;

namespace ProfRate.Controllers
{
    [Route("api/subjects")]
    [ApiController]
    public class SubjectController : ControllerBase
    {
        private readonly SubjectService _subjectService;

        public SubjectController(SubjectService subjectService)
        {
            _subjectService = subjectService;
        }

        // GET: api/subjects/GetAll
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯
        [HttpGet]
        [Route("GetAll")]
        public async Task<IActionResult> GetAllSubjects()
        {
            var subjects = await _subjectService.GetAllSubjects();
            return Ok(subjects);
        }

        // GET: api/subjects/GetById/5
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø§Ø¯Ø© Ø¨Ø§Ù„Ù€ ID
        [HttpGet]
        [Route("GetById/{id}")]
        public async Task<IActionResult> GetSubjectById(int id)
        {
            var subject = await _subjectService.GetSubjectById(id);
            if (subject == null)
            {
                return NotFound(new { message = "Ø§Ù„Ù…Ø§Ø¯Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©" });
            }
            return Ok(subject);
        }

        // POST: api/subjects/Add
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©
        [HttpPost]
        [Route("Add")]
        public async Task<IActionResult> AddSubject([FromBody] SubjectDTO dto)
        {
            var subject = await _subjectService.AddSubject(dto);
            return Ok(new { message = "ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­", subject });
        }



        // DELETE: api/subjects/Delete/5
        // Ø­Ø°Ù Ù…Ø§Ø¯Ø©
        [HttpDelete]
        [Route("Delete/{id}")]
        public async Task<IActionResult> DeleteSubject(int id)
        {
            var result = await _subjectService.DeleteSubject(id);
            if (!result)
            {
                return NotFound(new { message = "Ø§Ù„Ù…Ø§Ø¯Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©" });
            }
            return Ok(new { message = "ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­" });
        }
    }
}



================
File: AppDbContext.cs
================
using Microsoft.EntityFrameworkCore;
using ProfRate.Entities;

namespace ProfRate.Data
{
    // Ø§Ù„Ù€ DbContext - Ø¨ÙŠØ±Ø¨Ø· Ø§Ù„Ù€ Entities Ø¨Ø§Ù„Ù€ Database
    public class AppDbContext : DbContext
    {
        // Constructor - Ø¨ÙŠØ§Ø®Ø¯ Ø§Ù„Ù€ Options Ù…Ù† Program.cs
        public AppDbContext(DbContextOptions<AppDbContext> options) : base(options)
        {
        }

        // Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ ÙÙŠ Ø§Ù„Ù€ Database
        public DbSet<Admin> Admins { get; set; }
        public DbSet<Student> Students { get; set; }
        public DbSet<Lecturer> Lecturers { get; set; }
        public DbSet<Question> Questions { get; set; }
        public DbSet<Subject> Subjects { get; set; }
        public DbSet<Evaluation> Evaluations { get; set; }
        public DbSet<StudentSubject> StudentSubjects { get; set; }
        public DbSet<LecturerSubject> LecturerSubjects { get; set; }

        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            base.OnModelCreating(modelBuilder);

            // Ensure Username is Unique for Students
            modelBuilder.Entity<Student>()
                .HasIndex(u => u.Username)
                .IsUnique();

            // Ensure Username is Unique for Lecturers
            modelBuilder.Entity<Lecturer>()
                .HasIndex(u => u.Username)
                .IsUnique();

            // Admin -> Students (One-to-Many)
            modelBuilder.Entity<Student>()
                .HasOne(s => s.Admin)
                .WithMany(a => a.Students)
                .HasForeignKey(s => s.AdminId)
                .OnDelete(DeleteBehavior.Restrict);

            // Admin -> Lecturers (One-to-Many)
            modelBuilder.Entity<Lecturer>()
                .HasOne(l => l.Admin)
                .WithMany(a => a.Lecturers)
                .HasForeignKey(l => l.AdminId)
                .OnDelete(DeleteBehavior.Restrict);

            // Admin -> Questions (One-to-Many)
            modelBuilder.Entity<Question>()
                .HasOne(q => q.Admin)
                .WithMany(a => a.Questions)
                .HasForeignKey(q => q.AdminId)
                .OnDelete(DeleteBehavior.Restrict);

            // Evaluation relationships
            modelBuilder.Entity<Evaluation>()
                .HasOne(e => e.Student)
                .WithMany(s => s.Evaluations)
                .HasForeignKey(e => e.StudentId)
                .OnDelete(DeleteBehavior.Restrict);

            modelBuilder.Entity<Evaluation>()
                .HasOne(e => e.Lecturer)
                .WithMany(l => l.Evaluations)
                .HasForeignKey(e => e.LecturerId)
                .OnDelete(DeleteBehavior.Restrict);

            modelBuilder.Entity<Evaluation>()
                .HasOne(e => e.Question)
                .WithMany(q => q.Evaluations)
                .HasForeignKey(e => e.QuestionId)
                .OnDelete(DeleteBehavior.Restrict);

            modelBuilder.Entity<Evaluation>()
                .HasOne(e => e.Subject)
                .WithMany(s => s.Evaluations)
                .HasForeignKey(e => e.SubjectId)
                .OnDelete(DeleteBehavior.Restrict);

            // StudentSubject (Many-to-Many junction table)
            modelBuilder.Entity<StudentSubject>()
                .HasOne(ss => ss.Student)
                .WithMany(s => s.StudentSubjects)
                .HasForeignKey(ss => ss.StudentId)
                .OnDelete(DeleteBehavior.Restrict);

            modelBuilder.Entity<StudentSubject>()
                .HasOne(ss => ss.Subject)
                .WithMany(s => s.StudentSubjects)
                .HasForeignKey(ss => ss.SubjectId)
                .OnDelete(DeleteBehavior.Restrict);

            modelBuilder.Entity<StudentSubject>()
                .HasOne(ss => ss.Lecturer)
                .WithMany()
                .HasForeignKey(ss => ss.LecturerId)
                .OnDelete(DeleteBehavior.Restrict);

            // LecturerSubject (Many-to-Many junction table)
            modelBuilder.Entity<LecturerSubject>()
                .HasOne(ls => ls.Lecturer)
                .WithMany(l => l.LecturerSubjects)
                .HasForeignKey(ls => ls.LecturerId)
                .OnDelete(DeleteBehavior.Restrict);

            modelBuilder.Entity<LecturerSubject>()
                .HasOne(ls => ls.Subject)
                .WithMany(s => s.LecturerSubjects)
                .HasForeignKey(ls => ls.SubjectId)
                .OnDelete(DeleteBehavior.Restrict);
        }
    }
}



================
File: AuthDTOs.cs
================
namespace ProfRate.DTOs
{
    // DTO Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    public class LoginDTO
    {
        public string Username { get; set; } = string.Empty;
        public string Password { get; set; } = string.Empty;
        public string UserType { get; set; } = string.Empty; // "Admin", "Student", "Lecturer"
    }

    // DTO Ù„Ù„Ù€ Response Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    public class LoginResponseDTO
    {
        public bool Success { get; set; }
        public string Message { get; set; } = string.Empty;
        public string Token { get; set; } = string.Empty;
        public string UserType { get; set; } = string.Empty;
        public int UserId { get; set; }
    }
}



================
File: EntityDTOs.cs
================
using System.ComponentModel.DataAnnotations;

namespace ProfRate.DTOs
{
    // DTO Ù„Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø·Ø§Ù„Ø¨
    public class StudentDTO
    {
        public int StudentId { get; set; }
        
        [Required(ErrorMessage = "Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨")]
        [StringLength(50, ErrorMessage = "Ø§Ù„Ø§Ø³Ù… ÙŠØ¬Ø¨ Ø£Ù† Ù„Ø§ ÙŠØ²ÙŠØ¯ Ø¹Ù† 50 Ø­Ø±Ù")]
        public string FirstName { get; set; } = string.Empty;

        [Required(ErrorMessage = "Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ± Ù…Ø·Ù„ÙˆØ¨")]
        [StringLength(50, ErrorMessage = "Ø§Ù„Ø§Ø³Ù… ÙŠØ¬Ø¨ Ø£Ù† Ù„Ø§ ÙŠØ²ÙŠØ¯ Ø¹Ù† 50 Ø­Ø±Ù")]
        public string LastName { get; set; } = string.Empty;

        [Required(ErrorMessage = "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø·Ù„ÙˆØ¨")]
        [StringLength(50, MinimumLength = 3, ErrorMessage = "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 3 Ùˆ 50 Ø­Ø±Ù")]
        public string Username { get; set; } = string.Empty;

        [Required(ErrorMessage = "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø·Ù„ÙˆØ¨Ø©")]
        [StringLength(100, MinimumLength = 6, ErrorMessage = "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„")]
        public string Password { get; set; } = string.Empty;
        
        public int AdminId { get; set; }
    }

    // DTO Ù„Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ù…Ø­Ø§Ø¶Ø±
    public class LecturerDTO
    {
        public int LecturerId { get; set; }
        
        [Required(ErrorMessage = "Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨")]
        [StringLength(50)]
        public string FirstName { get; set; } = string.Empty;

        [Required(ErrorMessage = "Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ± Ù…Ø·Ù„ÙˆØ¨")]
        [StringLength(50)]
        public string LastName { get; set; } = string.Empty;

        [Required(ErrorMessage = "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø·Ù„ÙˆØ¨")]
        public string Username { get; set; } = string.Empty;

        [Required(ErrorMessage = "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø·Ù„ÙˆØ¨Ø©")]
        [MinLength(6, ErrorMessage = "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù‚ØµÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹")]
        public string Password { get; set; } = string.Empty;
        
        public int AdminId { get; set; }
    }

    // DTO Ù„Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¤Ø§Ù„
    public class QuestionDTO
    {
        public int QuestionId { get; set; }

        [Required(ErrorMessage = "Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù…Ø·Ù„ÙˆØ¨")]
        public string QuestionText { get; set; } = string.Empty;
        
        public int AdminId { get; set; }
    }

    // DTO Ù„Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ù…Ø§Ø¯Ø©
    public class SubjectDTO
    {
        public int SubjectId { get; set; }

        [Required(ErrorMessage = "Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ù…Ø·Ù„ÙˆØ¨")]
        public string SubjectName { get; set; } = string.Empty;
    }

    // DTO Ù„Ø¥Ø¶Ø§ÙØ© ØªÙ‚ÙŠÙŠÙ…
    public class EvaluationDTO
    {
        public int EvaluationId { get; set; }
        
        [Range(1, 5, ErrorMessage = "Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 1 Ùˆ 5")]
        public byte Rating { get; set; }
        
        [Required]
        public int StudentId { get; set; }
        [Required]
        public int QuestionId { get; set; }
        [Required]
        public int LecturerId { get; set; }
        [Required]
        public int SubjectId { get; set; }
    }

    // DTO Ù„Ø¹Ø±Ø¶ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
    public class EvaluationReportDTO
    {
        public int LecturerId { get; set; }
        public string LecturerName { get; set; } = string.Empty;
        public string SubjectName { get; set; } = string.Empty;
        public double AverageRating { get; set; }
        public int TotalEvaluations { get; set; }
    }

    public class StudentSubjectDTO
    {
        [Required]
        public int StudentId { get; set; }
        [Required]
        public int SubjectId { get; set; }
        public int? LecturerId { get; set; }
    }

    public class LecturerSubjectDTO
    {
        [Required]
        public int LecturerId { get; set; }
        [Required]
        public int SubjectId { get; set; }
    }
}



================
File: EvaluationResponseDTO.cs
================
namespace ProfRate.DTOs
{
    public class EvaluationResponseDTO
    {
        public int EvaluationId { get; set; }
        public int Rating { get; set; }
        public bool IsArchived { get; set; }
        
        public string StudentName { get; set; } = "";
        public string ParticpantName { get; set; } = ""; // Student Name but generic? No, let's use StudentName
        public string QuestionText { get; set; } = "";
        public string LecturerName { get; set; } = "";
        public string SubjectName { get; set; } = "";
    }
}



================
File: PagedResult.cs
================
namespace ProfRate.DTOs
{
    public class PagedResult<T>
    {
        public List<T> Items { get; set; } = new List<T>();
        public int TotalCount { get; set; }
        public int CurrentPage { get; set; }
        public int PageSize { get; set; }
        public int TotalPages { get; set; }
        public bool HasPrevious => CurrentPage > 1;
        public bool HasNext => CurrentPage < TotalPages;
    }
}



================
File: Admin.cs
================
namespace ProfRate.Entities
{
    public class Admin
    {
        public int AdminId { get; set; }
        public string Username { get; set; } = string.Empty;
        public string Password { get; set; } = string.Empty;
        public string FirstName { get; set; } = string.Empty;
        public string LastName { get; set; } = string.Empty;

        // Navigation Properties
        public List<Student> Students { get; set; } = new List<Student>();
        public List<Lecturer> Lecturers { get; set; } = new List<Lecturer>();
        public List<Question> Questions { get; set; } = new List<Question>();
    }
}



================
File: Evaluation.cs
================
namespace ProfRate.Entities
{
    // Ø§Ù„ØªÙ‚ÙŠÙŠÙ… - Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
    public class Evaluation
    {
        public int EvaluationId { get; set; }
        public byte Rating { get; set; }  // Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù…Ù† 1 Ù„Ù€ 5 Ù…Ø«Ù„Ø§Ù‹
        public bool IsArchived { get; set; } = false;

        // Foreign Keys
        public int StudentId { get; set; }
        public int QuestionId { get; set; }
        public int LecturerId { get; set; }
        public int SubjectId { get; set; }

        // Navigation Properties
        public Student Student { get; set; } = null!;
        public Question Question { get; set; } = null!;
        public Lecturer Lecturer { get; set; } = null!;
        public Subject Subject { get; set; } = null!;
    }
}



================
File: Lecturer.cs
================
using System.ComponentModel.DataAnnotations;

namespace ProfRate.Entities
{
    // Ø§Ù„Ù…Ø­Ø§Ø¶Ø± - Ø§Ù„Ù„ÙŠ Ø¨ÙŠØªÙ‚ÙŠÙ…
    public class Lecturer
    {
        public int LecturerId { get; set; }
        
        [MaxLength(50)]
        public string FirstName { get; set; } = string.Empty;
        
        [MaxLength(50)]
        public string LastName { get; set; } = string.Empty;
        
        [MaxLength(50)]
        public string Username { get; set; } = string.Empty;
        
        [MaxLength(100)]
        public string Password { get; set; } = string.Empty;

        // Foreign Key
        public int AdminId { get; set; }

        // Navigation Properties
        public Admin Admin { get; set; } = null!;
        public List<Evaluation> Evaluations { get; set; } = new List<Evaluation>();
        public List<LecturerSubject> LecturerSubjects { get; set; } = new List<LecturerSubject>();
    }
}



================
File: LecturerSubject.cs
================
namespace ProfRate.Entities
{
    // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† ÙˆØ§Ù„Ù…ÙˆØ§Ø¯ (Many-to-Many)
    public class LecturerSubject
    {
        public int LecturerSubjectId { get; set; }

        // Foreign Keys
        public int LecturerId { get; set; }
        public int SubjectId { get; set; }

        // Navigation Properties
        public Lecturer Lecturer { get; set; } = null!;
        public Subject Subject { get; set; } = null!;
    }
}



================
File: Question.cs
================
using System.ComponentModel.DataAnnotations;

namespace ProfRate.Entities
{
    // Ø§Ù„Ø³Ø¤Ø§Ù„ - Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
    public class Question
    {
        public int QuestionId { get; set; }
        
        [MaxLength(200)]
        public string QuestionText { get; set; } = string.Empty;

        // Foreign Key
        public int AdminId { get; set; }

        // Navigation Properties
        public Admin Admin { get; set; } = null!;
        public List<Evaluation> Evaluations { get; set; } = new List<Evaluation>();
    }
}



================
File: Student.cs
================
using System.ComponentModel.DataAnnotations;

namespace ProfRate.Entities
{
    // Ø§Ù„Ø·Ø§Ù„Ø¨ - Ø§Ù„Ù„ÙŠ Ø¨ÙŠØ¹Ù…Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
    public class Student
    {
        public int StudentId { get; set; }
        
        [MaxLength(50)]
        public string FirstName { get; set; } = string.Empty;
        
        [MaxLength(50)]
        public string LastName { get; set; } = string.Empty;
        
        [MaxLength(50)]
        public string Username { get; set; } = string.Empty;
        
        [MaxLength(100)]
        public string Password { get; set; } = string.Empty;

        // Foreign Key
        public int AdminId { get; set; }

        // Navigation Properties
        public Admin Admin { get; set; } = null!;
        public List<Evaluation> Evaluations { get; set; } = new List<Evaluation>();
        public List<StudentSubject> StudentSubjects { get; set; } = new List<StudentSubject>();
    }
}



================
File: StudentSubject.cs
================
namespace ProfRate.Entities
{
    // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ù…ÙˆØ§Ø¯ (Many-to-Many)
    public class StudentSubject
    {
        public int StudentSubjectId { get; set; }

        // Foreign Keys
        public int StudentId { get; set; }
        public int SubjectId { get; set; }
        public int? LecturerId { get; set; }

        // Navigation Properties
        public Student Student { get; set; } = null!;
        public Subject Subject { get; set; } = null!;
        public Lecturer? Lecturer { get; set; }
    }
}



================
File: Subject.cs
================
using System.ComponentModel.DataAnnotations;

namespace ProfRate.Entities
{
    // Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
    public class Subject
    {
        public int SubjectId { get; set; }
        
        [MaxLength(50)]
        public string SubjectName { get; set; } = string.Empty;

        // Navigation Properties
        public List<Evaluation> Evaluations { get; set; } = new List<Evaluation>();
        public List<StudentSubject> StudentSubjects { get; set; } = new List<StudentSubject>();
        public List<LecturerSubject> LecturerSubjects { get; set; } = new List<LecturerSubject>();
    }
}



================
File: ExceptionMiddleware.cs
================
using System.Net;
using System.Text.Json;

namespace ProfRate.Middleware
{
    public class ExceptionMiddleware
    {
        private readonly RequestDelegate _next;
        private readonly ILogger<ExceptionMiddleware> _logger;

        public ExceptionMiddleware(RequestDelegate next, ILogger<ExceptionMiddleware> logger)
        {
            _next = next;
            _logger = logger;
        }

        public async Task InvokeAsync(HttpContext context)
        {
            try
            {
                await _next(context);
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Something went wrong");
                await HandleExceptionAsync(context, ex);
            }
        }

        private static Task HandleExceptionAsync(HttpContext context, Exception exception)
        {
            context.Response.ContentType = "application/json";
            context.Response.StatusCode = (int)HttpStatusCode.InternalServerError;

            var isDevelopment = Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT") == "Development";

            var response = new
            {
                StatusCode = context.Response.StatusCode,
                Message = "Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹",
                Detailed = isDevelopment ? exception.Message : null // Show details only in Dev
            };
            
            return context.Response.WriteAsync(JsonSerializer.Serialize(response));
        }
    }
}



================
File: AuthService.cs
================
using Microsoft.EntityFrameworkCore;
using Microsoft.IdentityModel.Tokens;
using ProfRate.Data;
using ProfRate.DTOs;
using ProfRate.Entities;
using System.IdentityModel.Tokens.Jwt;
using System.Security.Claims;
using System.Text;

namespace ProfRate.Services
{
    // Service Ù„Ù„Ù€ Authentication - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù€ Token
    public class AuthService
    {
        private readonly AppDbContext _context;
        private readonly IConfiguration _configuration;

        public AuthService(AppDbContext context, IConfiguration configuration)
        {
            _context = context;
            _configuration = configuration;
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        public async Task<LoginResponseDTO> Login(LoginDTO loginDto)
        {
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø­Ø³Ø¨ Ù†ÙˆØ¹Ù‡
            if (loginDto.UserType == "Admin")
            {
                var admin = await _context.Admins
                    .AsNoTracking()
                    .FirstOrDefaultAsync(a => a.Username == loginDto.Username && a.Password == loginDto.Password);

                if (admin != null)
                {
                    var token = GenerateToken(admin.AdminId, admin.Username, "Admin");
                    return new LoginResponseDTO
                    {
                        Success = true,
                        Message = "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­",
                        Token = token,
                        UserType = "Admin",
                        UserId = admin.AdminId
                    };
                }
            }
            else if (loginDto.UserType == "Student")
            {
                var student = await _context.Students
                    .AsNoTracking()
                    .FirstOrDefaultAsync(s => s.Username == loginDto.Username && s.Password == loginDto.Password);

                if (student != null)
                {
                    var token = GenerateToken(student.StudentId, student.Username, "Student");
                    return new LoginResponseDTO
                    {
                        Success = true,
                        Message = "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­",
                        Token = token,
                        UserType = "Student",
                        UserId = student.StudentId
                    };
                }
            }
            else if (loginDto.UserType == "Lecturer")
            {
                var lecturer = await _context.Lecturers
                    .AsNoTracking()
                    .FirstOrDefaultAsync(l => l.Username == loginDto.Username && l.Password == loginDto.Password);

                if (lecturer != null)
                {
                    var token = GenerateToken(lecturer.LecturerId, lecturer.Username, "Lecturer");
                    return new LoginResponseDTO
                    {
                        Success = true,
                        Message = "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­",
                        Token = token,
                        UserType = "Lecturer",
                        UserId = lecturer.LecturerId
                    };
                }
            }

            // Ù„Ùˆ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯
            return new LoginResponseDTO
            {
                Success = false,
                Message = "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©",
                Token = "",
                UserType = "",
                UserId = 0
            };
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù€ JWT Token
        private string GenerateToken(int userId, string username, string userType)
        {
            var key = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(_configuration["Jwt:Key"]!));
            var credentials = new SigningCredentials(key, SecurityAlgorithms.HmacSha256);

            var claims = new[]
            {
                new Claim("UserId", userId.ToString()),
                new Claim("Username", username),
                new Claim("UserType", userType),
                new Claim(ClaimTypes.Role, userType)
            };

            var token = new JwtSecurityToken(
                issuer: _configuration["Jwt:Issuer"],
                audience: _configuration["Jwt:Audience"],
                claims: claims,
                expires: DateTime.Now.AddHours(24),
                signingCredentials: credentials
            );

            return new JwtSecurityTokenHandler().WriteToken(token);
        }
    }
}



================
File: EvaluationService.cs
================
using Microsoft.EntityFrameworkCore;
using ProfRate.Data;
using ProfRate.DTOs;
using ProfRate.Entities;

namespace ProfRate.Services
{
    // Service Ù„Ù„Ù€ Evaluations - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
    public class EvaluationService
    {
        private readonly AppDbContext _context;

        public EvaluationService(AppDbContext context)
        {
            _context = context;
        }

        // Ø¥Ø¶Ø§ÙØ© ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯ Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙƒØ±Ø§Ø±
        public async Task<Evaluation> AddEvaluation(EvaluationDTO dto)
        {
            if (dto.StudentId <= 0 || dto.LecturerId <= 0 || dto.SubjectId <= 0 || dto.QuestionId <= 0)
            {
                throw new InvalidOperationException("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø© (Ù…Ø¹Ø±ÙØ§Øª ØºÙŠØ± ØµØ§Ù„Ø­Ø©).");
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù‡Ù„ Ù‚Ø§Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨ØªÙ‚ÙŠÙŠÙ… Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù„Ù†ÙØ³ Ø§Ù„Ø¯ÙƒØªÙˆØ± ÙˆØ§Ù„Ù…Ø§Ø¯Ø© Ù…Ù† Ù‚Ø¨Ù„ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ
            var exists = await _context.Evaluations
                .AnyAsync(e => e.StudentId == dto.StudentId && 
                               e.LecturerId == dto.LecturerId && 
                               e.SubjectId == dto.SubjectId && 
                               e.QuestionId == dto.QuestionId &&
                               !e.IsArchived);

            if (exists)
            {
                throw new InvalidOperationException("Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨ØªÙ‚ÙŠÙŠÙ… Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù„Ù„Ù…Ø­Ø§Ø¶Ø± ÙˆØ§Ù„Ù…Ø§Ø¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹.");
            }

            var evaluation = new Evaluation
            {
                Rating = dto.Rating,
                StudentId = dto.StudentId,
                QuestionId = dto.QuestionId,
                LecturerId = dto.LecturerId,
                SubjectId = dto.SubjectId,
                IsArchived = false
            };

            _context.Evaluations.Add(evaluation);
            await _context.SaveChangesAsync();
            return evaluation;
        }

        // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª (Ø£Ø±Ø´ÙØ© Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©)
        public async Task<bool> ResetEvaluations()
        {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
            var activeEvaluations = await _context.Evaluations
                .Where(e => !e.IsArchived)
                .ToListAsync();

            if (activeEvaluations.Any())
            {
                foreach (var eval in activeEvaluations)
                {
                    eval.IsArchived = true;
                }
                await _context.SaveChangesAsync();
                return true;
            }
            return false;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù…Ø­Ø§Ø¶Ø± Ù…Ø¹ÙŠÙ† (Ù…Ø¬Ù…Ø¹Ø© ÙˆØ¨Ø¯ÙˆÙ† Ø£Ø³Ù…Ø§Ø¡ Ø·Ù„Ø§Ø¨)
        public async Task<List<EvaluationResponseDTO>> GetEvaluationsByLecturer(int lecturerId)
        {
            return await _context.Evaluations.AsNoTracking()
                .Include(e => e.Student)
                .Include(e => e.Lecturer)
                .Include(e => e.Subject)
                .Where(e => e.LecturerId == lecturerId && !e.IsArchived)
                .GroupBy(e => new { 
                    e.StudentId, 
                    // No need for Student details here as it should be anonymous
                    e.SubjectId, 
                    SubjectName = e.Subject.SubjectName 
                })
                .Select(g => new EvaluationResponseDTO
                {
                    EvaluationId = g.First().EvaluationId,
                    Rating = (int)Math.Round(g.Average(e => e.Rating)),
                    IsArchived = false,
                    StudentName = "Ø·Ø§Ù„Ø¨", // Ø¥Ø®ÙØ§Ø¡ Ù‡ÙˆÙŠØ© Ø§Ù„Ø·Ø§Ù„Ø¨
                    LecturerName = "", // Not needed for own view
                    SubjectName = g.Key.SubjectName,
                    QuestionText = $"ØªÙ‚ÙŠÙŠÙ… Ø¹Ø§Ù… ({g.Count()} Ø£Ø³Ø¦Ù„Ø©)"
                })
                .ToListAsync();
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù„ÙƒÙ„ Ù…Ø­Ø§Ø¶Ø±
        public async Task<List<EvaluationReportDTO>> GetEvaluationReport()
        {
            var report = await _context.Evaluations.AsNoTracking()
                .Where(e => !e.IsArchived) // ÙÙ‚Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
                .GroupBy(e => new { e.LecturerId, e.Lecturer.FirstName, e.Lecturer.LastName, e.SubjectId, e.Subject.SubjectName })
                .Select(g => new EvaluationReportDTO
                {
                    LecturerId = g.Key.LecturerId,
                    LecturerName = g.Key.FirstName + " " + g.Key.LastName,
                    SubjectName = g.Key.SubjectName,
                    AverageRating = g.Average(e => e.Rating),
                    TotalEvaluations = g.Count()
                })
                .ToListAsync();

            return report;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª (Ù…Ø¬Ù…Ø¹Ø© Ù„ÙƒÙ„ Ø·Ø§Ù„Ø¨/Ø¯ÙƒØªÙˆØ±/Ù…Ø§Ø¯Ø©)
        public async Task<List<EvaluationResponseDTO>> GetAllEvaluations()
        {
            return await _context.Evaluations.AsNoTracking()
                .Include(e => e.Student)
                .Include(e => e.Lecturer)
                .Include(e => e.Subject)
                .Where(e => !e.IsArchived)
                .GroupBy(e => new { 
                    e.StudentId, 
                    StudentFirstName = e.Student.FirstName, 
                    StudentLastName = e.Student.LastName,
                    e.LecturerId, 
                    LecturerFirstName = e.Lecturer.FirstName, 
                    LecturerLastName = e.Lecturer.LastName,
                    e.SubjectId, 
                    SubjectName = e.Subject.SubjectName 
                })
                .Select(g => new EvaluationResponseDTO
                {
                    EvaluationId = g.First().EvaluationId, // Ù…Ø¬Ø±Ø¯ ID ØªÙ…Ø«ÙŠÙ„ÙŠ
                    Rating = (int)Math.Round(g.Average(e => e.Rating)), // Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù„Ù„Ø£ÙŠØ¦Ù„Ø©
                    IsArchived = false,
                    StudentName = g.Key.StudentFirstName + " " + g.Key.StudentLastName,
                    LecturerName = g.Key.LecturerFirstName + " " + g.Key.LecturerLastName,
                    SubjectName = g.Key.SubjectName,
                    QuestionText = $"ØªÙ‚ÙŠÙŠÙ… Ø¹Ø§Ù… ({g.Count()} Ø£Ø³Ø¦Ù„Ø©)" // Ù†Øµ ØªÙˆØ¶ÙŠØ­ÙŠ Ø¨Ø¯Ù„ Ø³Ø¤Ø§Ù„ Ù…Ø­Ø¯Ø¯
                })
                .ToListAsync();
        }
    }
}



================
File: LecturerService.cs
================
using Microsoft.EntityFrameworkCore;
using ProfRate.Data;
using ProfRate.DTOs;
using ProfRate.Entities;

namespace ProfRate.Services
{
    // Service Ù„Ù„Ù€ Lecturers - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†
    public class LecturerService
    {
        private readonly AppDbContext _context;

        public LecturerService(AppDbContext context)
        {
            _context = context;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†
        public async Task<List<Lecturer>> GetAllLecturers()
        {
            return await _context.Lecturers.AsNoTracking().OrderBy(l => l.FirstName).ToListAsync();
        }

        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† (Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† (Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)
        public async Task<List<Lecturer>> Search(string query)
        {
            if (string.IsNullOrWhiteSpace(query))
                return new List<Lecturer>();
            
            // Sanitize Input
            query = query.Trim();
            if (query.Length > 100) query = query.Substring(0, 100);
            query = System.Text.RegularExpressions.Regex.Replace(query, @"[^\w\s\u0600-\u06FF]", "");

            return await _context.Lecturers
                .AsNoTracking()
                .Where(l => l.Username.Contains(query) || 
                            (l.FirstName + " " + l.LastName).Contains(query))
                .OrderBy(l => l.FirstName)
                .Take(100)
                .ToListAsync();
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø­Ø§Ø¶Ø± Ø¨Ø§Ù„Ù€ ID
        public async Task<Lecturer?> GetLecturerById(int id)
        {
            return await _context.Lecturers.FindAsync(id);
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø§Ø¶Ø± Ø¬Ø¯ÙŠØ¯
        public async Task<Lecturer> AddLecturer(LecturerDTO dto)
        {
            if (await _context.Lecturers.AnyAsync(l => l.Username == dto.Username))
                throw new InvalidOperationException("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„");

            var lecturer = new Lecturer
            {
                FirstName = dto.FirstName,
                LastName = dto.LastName,
                Username = dto.Username,
                Password = dto.Password, // Reverted to Plain Text
                AdminId = dto.AdminId
            };

            _context.Lecturers.Add(lecturer);
            await _context.SaveChangesAsync();
            return lecturer;
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ù…Ø­Ø§Ø¶Ø±
        public async Task<Lecturer?> UpdateLecturer(int id, LecturerDTO dto)
        {
            var lecturer = await _context.Lecturers.FindAsync(id);
            if (lecturer == null) return null;

            if (await _context.Lecturers.AnyAsync(l => l.Username == dto.Username && l.LecturerId != id))
                throw new InvalidOperationException("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„");

            lecturer.FirstName = dto.FirstName;
            lecturer.LastName = dto.LastName;
            lecturer.Username = dto.Username;
            lecturer.Password = dto.Password; // Reverted to Plain Text

            await _context.SaveChangesAsync();
            return lecturer;
        }

        // Ø­Ø°Ù Ù…Ø­Ø§Ø¶Ø±
        // Ø­Ø°Ù Ù…Ø­Ø§Ø¶Ø± (Ù…Ø¹ Ø­Ø°Ù ÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©)
        public async Task<bool> DeleteLecturer(int id)
        {
            var lecturer = await _context.Lecturers
                .Include(l => l.Evaluations)
                .Include(l => l.LecturerSubjects)
                .FirstOrDefaultAsync(l => l.LecturerId == id);

            if (lecturer == null) return false;

            // Manual Cascade Delete
            if (lecturer.Evaluations.Any())
                _context.Evaluations.RemoveRange(lecturer.Evaluations);

            if (lecturer.LecturerSubjects.Any())
                _context.LecturerSubjects.RemoveRange(lecturer.LecturerSubjects);

            _context.Lecturers.Remove(lecturer);
            await _context.SaveChangesAsync();
            return true;
        }
    }
}



================
File: LecturerSubjectService.cs
================
using Microsoft.EntityFrameworkCore;
using ProfRate.Data;
using ProfRate.DTOs;
using ProfRate.Entities;

namespace ProfRate.Services
{
    // Service Ù„Ù„Ù€ LecturerSubjects - Ø¥Ø¯Ø§Ø±Ø© Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯
    public class LecturerSubjectService
    {
        private readonly AppDbContext _context;

        public LecturerSubjectService(AppDbContext context)
        {
            _context = context;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·Ø§Øª
        public async Task<List<LecturerSubject>> GetAll()
        {
            return await _context.LecturerSubjects
                .Include(ls => ls.Lecturer)
                .Include(ls => ls.Subject)
                .ToListAsync();
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§Ø¯ Ù…Ø­Ø§Ø¶Ø± Ù…Ø¹ÙŠÙ†
        public async Task<List<LecturerSubject>> GetByLecturer(int lecturerId)
        {
            return await _context.LecturerSubjects
                .Where(ls => ls.LecturerId == lecturerId)
                .Include(ls => ls.Subject)
                .ToListAsync();
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ù…Ø§Ø¯Ø© Ù…Ø¹ÙŠÙ†Ø©
        public async Task<List<LecturerSubject >> GetBySubject(int subjectId)
        {
            return await _context.LecturerSubjects
                .Where(ls => ls.SubjectId == subjectId)
                .Include(ls => ls.Lecturer)
                .ToListAsync();
        }

        // Ø¥Ø¶Ø§ÙØ© Ø±Ø¨Ø· Ø¬Ø¯ÙŠØ¯
        public async Task<(bool Success, string Message)> AddLecturerSubject(LecturerSubjectDTO dto)
        {
            var exists = await _context.LecturerSubjects
                .AnyAsync(ls => ls.LecturerId == dto.LecturerId && ls.SubjectId == dto.SubjectId);
            
            if (exists)
            {
                return (false, "Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ù…Ø¹ÙŠÙ† Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø©");
            }

            var entry = new LecturerSubject
            {
                LecturerId = dto.LecturerId,
                SubjectId = dto.SubjectId
            };

            _context.LecturerSubjects.Add(entry);
            await _context.SaveChangesAsync();
            return (true, "ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­");
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ø±Ø¨Ø·
        public async Task<(bool Success, string Message)> UpdateLecturerSubject(int id, LecturerSubjectDTO dto)
        {
            var entry = await _context.LecturerSubjects.FindAsync(id);
            if (entry == null) return (false, "Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");

            bool exists = await _context.LecturerSubjects
                .AnyAsync(ls => ls.LecturerId == dto.LecturerId && ls.SubjectId == dto.SubjectId && ls.LecturerSubjectId != id);

            if (exists)
            {
                return (false, "Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ù…Ø¹ÙŠÙ† Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø©");
            }

            // Capture old values
            var oldLecturerId = entry.LecturerId;
            var oldSubjectId = entry.SubjectId;

            // Apply new values
            entry.LecturerId = dto.LecturerId;
            entry.SubjectId = dto.SubjectId;

            // Cascade Update: Update related StudentAssignments
            var affectedStudents = await _context.StudentSubjects
                .Where(ss => ss.LecturerId == oldLecturerId && ss.SubjectId == oldSubjectId)
                .ToListAsync();

            if (affectedStudents.Any())
            {
                foreach (var studentSubject in affectedStudents)
                {
                    studentSubject.LecturerId = dto.LecturerId;
                    studentSubject.SubjectId = dto.SubjectId; // Usually subject stays same in this specific edit scenario, but safe to sync
                }
            }

            await _context.SaveChangesAsync();
            return (true, "ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­ (ÙˆØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ†)");
        }

        // Ø­Ø°Ù Ø±Ø¨Ø·
        public async Task<bool> DeleteLecturerSubject(int id)
        {
            var entry = await _context.LecturerSubjects.FindAsync(id);
            if (entry == null) return false;

            _context.LecturerSubjects.Remove(entry);
            await _context.SaveChangesAsync();
            return true;
        }
    }
}



================
File: QuestionService.cs
================
using Microsoft.EntityFrameworkCore;
using ProfRate.Data;
using ProfRate.DTOs;
using ProfRate.Entities;

namespace ProfRate.Services
{
    // Service Ù„Ù„Ù€ Questions - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
    public class QuestionService
    {
        private readonly AppDbContext _context;

        public QuestionService(AppDbContext context)
        {
            _context = context;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
        public async Task<List<Question>> GetAllQuestions()
        {
            return await _context.Questions.ToListAsync();
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ø¤Ø§Ù„ Ø¨Ø§Ù„Ù€ ID
        public async Task<Question?> GetQuestionById(int id)
        {
            return await _context.Questions.FindAsync(id);
        }

        // Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯
        public async Task<Question> AddQuestion(QuestionDTO dto)
        {
            var question = new Question
            {
                QuestionText = dto.QuestionText,
                AdminId = dto.AdminId
            };

            _context.Questions.Add(question);
            await _context.SaveChangesAsync();
            return question;
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¤Ø§Ù„
        public async Task<Question?> UpdateQuestion(int id, QuestionDTO dto)
        {
            var question = await _context.Questions.FindAsync(id);
            if (question == null) return null;

            question.QuestionText = dto.QuestionText;

            await _context.SaveChangesAsync();
            return question;
        }

        // Ø­Ø°Ù Ø³Ø¤Ø§Ù„
        // Ø­Ø°Ù Ø³Ø¤Ø§Ù„ (Ù…Ø¹ Ø­Ø°Ù ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙ‡ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©)
        public async Task<bool> DeleteQuestion(int id)
        {
            var question = await _context.Questions
                .Include(q => q.Evaluations)
                .FirstOrDefaultAsync(q => q.QuestionId == id);

            if (question == null) return false;

            if (question.Evaluations.Any())
                _context.Evaluations.RemoveRange(question.Evaluations);

            _context.Questions.Remove(question);
            await _context.SaveChangesAsync();
            return true;
        }
    }
}



================
File: StudentService.cs
================
using Microsoft.EntityFrameworkCore;
using ProfRate.Data;
using ProfRate.DTOs;
using ProfRate.Entities;

namespace ProfRate.Services
{
    // Service Ù„Ù„Ù€ Students - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨
    public class StudentService
    {
        private readonly AppDbContext _context;

        public StudentService(AppDbContext context)
        {
            _context = context;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨ (Ù…Ø¹ Pagination)
        public async Task<PagedResult<Student>> GetAllStudents(int page = 1, int pageSize = 20)
        {
            var totalStudents = await _context.Students.CountAsync();

            var students = await _context.Students
                .AsNoTracking()
                .OrderBy(s => s.FirstName)
                .Skip((page - 1) * pageSize)
                .Take(pageSize)
                .ToListAsync();

            return new PagedResult<Student>
            {
                Items = students,
                TotalCount = totalStudents,
                CurrentPage = page,
                PageSize = pageSize,
                TotalPages = (int)Math.Ceiling(totalStudents / (double)pageSize)
            };
        }

        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø·Ù„Ø§Ø¨ (Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø·Ù„Ø§Ø¨ (Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)
        public async Task<List<Student>> Search(string query)
        {
            if (string.IsNullOrWhiteSpace(query))
                return new List<Student>();

            // Sanitize Input
            query = query.Trim();
            if (query.Length > 100) query = query.Substring(0, 100);
            query = System.Text.RegularExpressions.Regex.Replace(query, @"[^\w\s\u0600-\u06FF]", "");

            return await _context.Students
                .AsNoTracking()
                .Where(s => s.Username.Contains(query) || 
                            (s.FirstName + " " + s.LastName).Contains(query))
                .OrderBy(s => s.FirstName)
                .Take(100)
                .ToListAsync();
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ù€ ID
        public async Task<Student?> GetStudentById(int id)
        {
            return await _context.Students.FindAsync(id);
        }

        // Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
        public async Task<Student> AddStudent(StudentDTO dto)
        {
            var student = new Student
            {
                FirstName = dto.FirstName,
                LastName = dto.LastName,
                Username = dto.Username,
                Password = dto.Password, // Reverted to Plain Text
                AdminId = dto.AdminId
            };

            _context.Students.Add(student);
            await _context.SaveChangesAsync();
            return student;
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ø·Ø§Ù„Ø¨
        public async Task<Student?> UpdateStudent(int id, StudentDTO dto)
        {
            var student = await _context.Students.FirstOrDefaultAsync(s => s.StudentId == id);
            if (student == null) return null;

            student.FirstName = dto.FirstName;
            student.LastName = dto.LastName;
            student.Username = dto.Username;
            student.Password = dto.Password; // Reverted to Plain Text

            await _context.SaveChangesAsync();
            return student;
        }

        // Ø­Ø°Ù Ø·Ø§Ù„Ø¨
        // Ø­Ø°Ù Ø·Ø§Ù„Ø¨ (Ù…Ø¹ Ø­Ø°Ù ÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©)
        public async Task<bool> DeleteStudent(int id)
        {
            var student = await _context.Students
                .Include(s => s.Evaluations)
                .Include(s => s.StudentSubjects)
                .FirstOrDefaultAsync(s => s.StudentId == id);

            if (student == null) return false;

            // Manual Cascade Delete
            if (student.Evaluations.Any())
                _context.Evaluations.RemoveRange(student.Evaluations);

            if (student.StudentSubjects.Any())
                _context.StudentSubjects.RemoveRange(student.StudentSubjects);

            _context.Students.Remove(student);
            await _context.SaveChangesAsync();
            return true;
        }
    }
}



================
File: StudentSubjectService.cs
================
using Microsoft.EntityFrameworkCore;
using ProfRate.Data;
using ProfRate.DTOs;
using ProfRate.Entities;

namespace ProfRate.Services
{
    // Service Ù„Ù„Ù€ StudentSubjects - Ø¥Ø¯Ø§Ø±Ø© Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯
    public class StudentSubjectService
    {
        private readonly AppDbContext _context;

        public StudentSubjectService(AppDbContext context)
        {
            _context = context;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·Ø§Øª
        public async Task<List<StudentSubject>> GetAll()
        {
            return await _context.StudentSubjects
                .Include(ss => ss.Student)
                .Include(ss => ss.Subject)
                .Include(ss => ss.Lecturer)
                .ToListAsync();
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§Ø¯ Ø·Ø§Ù„Ø¨ Ù…Ø¹ÙŠÙ†
        public async Task<List<StudentSubject>> GetByStudent(int studentId)
        {
            return await _context.StudentSubjects
                .Where(ss => ss.StudentId == studentId)
                .Include(ss => ss.Subject)
                .Include(ss => ss.Lecturer)
                .ToListAsync();
        }

        // Ø¥Ø¶Ø§ÙØ© Ø±Ø¨Ø· Ø¬Ø¯ÙŠØ¯
        public async Task<(bool Success, string Message)> AddStudentSubject(StudentSubjectDTO dto)
        {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„ØªÙƒØ±Ø§Ø± (Ù†ÙØ³ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙˆØ§Ù„Ù…Ø§Ø¯Ø©)
            var exists = await _context.StudentSubjects
                .AnyAsync(ss => ss.StudentId == dto.StudentId && ss.SubjectId == dto.SubjectId);

            if (exists)
            {
                return (false, "Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø© (Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø© Ù…Ø±ØªÙŠÙ†)");
            }

            var entry = new StudentSubject
            {
                StudentId = dto.StudentId,
                SubjectId = dto.SubjectId,
                LecturerId = dto.LecturerId
            };

            _context.StudentSubjects.Add(entry);
            await _context.SaveChangesAsync();
            return (true, "ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­");
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ø±Ø¨Ø·
        public async Task<(bool Success, string Message)> UpdateStudentSubject(int id, StudentSubjectDTO dto)
        {
            var entry = await _context.StudentSubjects.FindAsync(id);
            if (entry == null) return (false, "Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„ØªÙƒØ±Ø§Ø± (Ù„Ùˆ ØºÙŠØ±Ù†Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø§Ù„Ù…Ø§Ø¯Ø©)
            bool exists = await _context.StudentSubjects
                .AnyAsync(ss => ss.StudentId == dto.StudentId && ss.SubjectId == dto.SubjectId && ss.StudentSubjectId != id);

            if (exists)
            {
                return (false, "Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø©");
            }

            entry.StudentId = dto.StudentId;
            entry.SubjectId = dto.SubjectId;
            entry.LecturerId = dto.LecturerId;

            await _context.SaveChangesAsync();
            return (true, "ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­");
        }

        // Ø­Ø°Ù Ø±Ø¨Ø·
        public async Task<bool> DeleteStudentSubject(int id)
        {
            var entry = await _context.StudentSubjects.FindAsync(id);
            if (entry == null) return false;

            _context.StudentSubjects.Remove(entry);
            await _context.SaveChangesAsync();
            return true;
        }
    }
}



================
File: SubjectService.cs
================
using Microsoft.EntityFrameworkCore;
using ProfRate.Data;
using ProfRate.DTOs;
using ProfRate.Entities;

namespace ProfRate.Services
{
    // Service Ù„Ù„Ù€ Subjects - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯
    public class SubjectService
    {
        private readonly AppDbContext _context;

        public SubjectService(AppDbContext context)
        {
            _context = context;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯
        public async Task<List<Subject>> GetAllSubjects()
        {
            return await _context.Subjects.AsNoTracking().ToListAsync();
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø§Ø¯Ø© Ø¨Ø§Ù„Ù€ ID
        public async Task<Subject?> GetSubjectById(int id)
        {
            return await _context.Subjects.FindAsync(id);
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©
        public async Task<Subject> AddSubject(SubjectDTO dto)
        {
            var subject = new Subject
            {
                SubjectName = dto.SubjectName
            };

            _context.Subjects.Add(subject);
            await _context.SaveChangesAsync();
            return subject;
        }



        // Ø­Ø°Ù Ù…Ø§Ø¯Ø©
        // Ø­Ø°Ù Ù…Ø§Ø¯Ø© (Ù…Ø¹ Ø­Ø°Ù ÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡Ø§ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©)
        public async Task<bool> DeleteSubject(int id)
        {
            var subject = await _context.Subjects
                .Include(s => s.Evaluations)
                .Include(s => s.StudentSubjects)
                .Include(s => s.LecturerSubjects)
                .FirstOrDefaultAsync(s => s.SubjectId == id);

            if (subject == null) return false;

            // Manual Cascade Delete
            if (subject.Evaluations.Any())
                _context.Evaluations.RemoveRange(subject.Evaluations);

            if (subject.StudentSubjects.Any())
                _context.StudentSubjects.RemoveRange(subject.StudentSubjects);

            if (subject.LecturerSubjects.Any())
                _context.LecturerSubjects.RemoveRange(subject.LecturerSubjects);

            _context.Subjects.Remove(subject);
            await _context.SaveChangesAsync();
            return true;
        }
    }
}



================
File: api.js
================
// ===== ProfRate API Service =====

const API_URL = '/api';
// const API_URL = 'http://localhost:5176/api'; // Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ùˆ Ø´ØºØ§Ù„ Front-end Live Server Ø¨Ø¹ÙŠØ¯ Ø¹Ù† Ø§Ù„Ø¨Ø§Ùƒ Ø¥Ù†Ø¯

// Helper function Ù„Ù„Ù€ API calls
async function apiCall(endpoint, method = 'GET', data = null) {
    const options = {
        method: method,
        headers: {
            'Content-Type': 'application/json'
        }
    };

    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ Token Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯
    const token = localStorage.getItem('token');
    if (token) {
        options.headers['Authorization'] = `Bearer ${token}`;
    }

    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ Body Ù„Ùˆ ÙÙŠÙ‡ Data
    if (data) {
        options.body = JSON.stringify(data);
    }

    try {
        const response = await fetch(`${API_URL}${endpoint}`, options);
        const result = await response.json();
        return { success: response.ok, data: result };
    } catch (error) {
        console.error('API Error:', error);

        if (error.message === 'Failed to fetch') {
            return { success: false, data: { message: 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±ØŒ ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø§Ùƒ Ø¥Ù†Ø¯' } };
        }

        if (error.status === 401) {
            localStorage.clear();
            window.location.href = '/frontend/login.html';
            return { success: false, data: { message: 'Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©ØŒ ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰' } };
        }

        return { success: false, data: { message: error.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹' } };
    }
}

// ===== Auth API =====
const AuthAPI = {
    login: (username, password, userType) => {
        return apiCall('/auth/login', 'POST', { username, password, userType });
    }
};

// ===== Students API =====
const StudentsAPI = {
    getAll: (page = 1, pageSize = 20) => apiCall(`/students/GetAll?page=${page}&pageSize=${pageSize}`),
    search: (query) => apiCall(`/students/Search?query=${query}`),
    getById: (id) => apiCall(`/students/GetById/${id}`),
    add: (data) => apiCall('/students/Add', 'POST', data),
    update: (id, data) => apiCall(`/students/Update/${id}`, 'PUT', data),
    delete: (id) => apiCall(`/students/Delete/${id}`, 'DELETE')
};

// ===== StudentSubjects API =====
const StudentSubjectsAPI = {
    getAll: () => apiCall('/studentsubjects/GetAll'),
    getByStudent: (id) => apiCall(`/studentsubjects/GetByStudent/${id}`),
    getBySubject: (id) => apiCall(`/studentsubjects/GetBySubject/${id}`),
    add: (data) => apiCall('/studentsubjects/Add', 'POST', data),
    update: (id, data) => apiCall(`/studentsubjects/Update/${id}`, 'PUT', data),
    delete: (id) => apiCall(`/studentsubjects/Delete/${id}`, 'DELETE')
};

// ===== Lecturers API =====
const LecturersAPI = {
    getAll: () => apiCall('/lecturers/GetAll'),
    search: (query) => apiCall(`/lecturers/Search?query=${query}`),
    getById: (id) => apiCall(`/lecturers/GetById/${id}`),
    add: (data) => apiCall('/lecturers/Add', 'POST', data),
    update: (id, data) => apiCall(`/lecturers/Update/${id}`, 'PUT', data),
    delete: (id) => apiCall(`/lecturers/Delete/${id}`, 'DELETE')
};

// ===== LecturerSubjects API =====
const LecturerSubjectsAPI = {
    getAll: () => apiCall('/lecturersubjects/GetAll'),
    getByLecturer: (id) => apiCall(`/lecturersubjects/GetByLecturer/${id}`),
    getBySubject: (id) => apiCall(`/lecturersubjects/GetBySubject/${id}`),
    add: (data) => apiCall('/lecturersubjects/Add', 'POST', data),
    update: (id, data) => apiCall(`/lecturersubjects/Update/${id}`, 'PUT', data),
    delete: (id) => apiCall(`/lecturersubjects/Delete/${id}`, 'DELETE')
};

// ===== Questions API =====
const QuestionsAPI = {
    getAll: () => apiCall('/questions/GetAll'),
    add: (data) => apiCall('/questions/Add', 'POST', data),
    update: (id, data) => apiCall(`/questions/Update/${id}`, 'PUT', data),
    delete: (id) => apiCall(`/questions/Delete/${id}`, 'DELETE')
};

// ===== Subjects API =====
const SubjectsAPI = {
    getAll: () => apiCall('/subjects/GetAll'),
    add: (data) => apiCall('/subjects/Add', 'POST', data),
    update: (id, data) => apiCall(`/subjects/Update/${id}`, 'PUT', data),
    delete: (id) => apiCall(`/subjects/Delete/${id}`, 'DELETE')
};

// ===== Evaluations API =====
const EvaluationsAPI = {
    getAll: () => apiCall('/evaluations/GetAll'),
    getReport: () => apiCall('/evaluations/GetReport'),
    add: (data) => apiCall('/evaluations/Add', 'POST', data)
};

// ===== Helper Functions =====

// Ø¹Ø±Ø¶ Alert
function showAlert(message, type = 'success') {
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type}`;
    alertDiv.textContent = message;

    const container = document.querySelector('.main-content') || document.body;
    container.insertBefore(alertDiv, container.firstChild);

    setTimeout(() => alertDiv.remove(), 3000);
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
function checkAuth() {
    const token = localStorage.getItem('token');
    const userType = localStorage.getItem('userType');

    if (!token) {
        window.location.href = '../login.html';
        return false;
    }
    return { token, userType };
}

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
function logout() {
    localStorage.removeItem('token');
    localStorage.removeItem('userType');
    localStorage.removeItem('userId');
    window.location.href = '../login.html';
    window.location.href = '../login.html';
}

// Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø­Ø« Ù…Ù†Ø³Ø¯Ù„Ø© (Searchable Dropdown)
function setupSearchDropdown(inputId, listId, apiSearchFn, onSelect) {
    const input = document.getElementById(inputId);
    const list = document.getElementById(listId);
    let timeout = null;

    input.addEventListener('input', function () {
        const query = this.value;
        if (query.length < 1) {
            list.style.display = 'none';
            return;
        }

        clearTimeout(timeout);
        timeout = setTimeout(async () => {
            const result = await apiSearchFn(query);
            if (result.success && result.data.length > 0) {
                list.innerHTML = result.data.map(item =>
                    `<div class="search-item" data-id="${item.studentId || item.lecturerId}">
                        ${item.firstName} ${item.lastName} (${item.username})
                    </div>`
                ).join('');
                list.style.display = 'block';

                // Handle Selection
                document.querySelectorAll(`#${listId} .search-item`).forEach(div => {
                    div.addEventListener('click', function () {
                        input.value = this.innerText;
                        list.style.display = 'none';
                        onSelect(this.getAttribute('data-id'));
                    });
                });
            } else {
                list.innerHTML = '<div class="search-item disabled">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>';
                list.style.display = 'block';
            }
        }, 300); // Debounce
    });

    // Hide list when clicking outside
    document.addEventListener('click', function (e) {
        if (e.target !== input && e.target !== list) {
            list.style.display = 'none';
        }
    });
}



================
File: assign-lecturers.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</title>
    <link rel="stylesheet" href="../css/style.css?v=2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .search-results {
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .search-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }

        .search-item:hover {
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="dashboard.html" class="nav-link"><i class="fas fa-home"></i><span>Ù„ÙˆØ­Ø©
                            Ø§Ù„ØªØ­ÙƒÙ…</span></a></li>
                <li class="nav-item"><a href="students.html" class="nav-link"><i
                            class="fas fa-user-graduate"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</span></a></li>
                <li class="nav-item"><a href="lecturers.html" class="nav-link"><i
                            class="fas fa-chalkboard-teacher"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span></a></li>
                <li class="nav-item"><a href="subjects.html" class="nav-link"><i class="fas fa-book"></i><span>Ø¥Ø¯Ø§Ø±Ø©
                            Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="questions.html" class="nav-link"><i
                            class="fas fa-question-circle"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span></a></li>
                <li class="nav-item"><a href="assign-students.html" class="nav-link"><i
                            class="fas fa-link"></i><span>Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="assign-lecturers.html" class="nav-link active"><i
                            class="fas fa-link"></i><span>Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="reports.html" class="nav-link"><i
                            class="fas fa-chart-bar"></i><span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</h2>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ØªØ¹ÙŠÙŠÙ† Ù…Ø­Ø§Ø¶Ø± Ù„Ù…Ø§Ø¯Ø©</h3>
                </div>
                <form id="assignForm">
                    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                        <div class="form-group" style="flex: 1; position: relative;">
                            <label class="form-label">Ø§Ù„Ù…Ø­Ø§Ø¶Ø± (Ø¨Ø­Ø«)</label>
                            <input type="hidden" id="selectedLecturerId">
                            <input type="text" class="form-control" id="lecturerSearch"
                                placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±..." autocomplete="off">
                            <div id="lecturerResults" class="search-results"></div>
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label class="form-label">Ø§Ù„Ù…Ø§Ø¯Ø©</label>
                            <select class="form-control" id="subjectId" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø©</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ø§Ù„Ù…Ø§Ø¯Ø©
                    </button>
                </form>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† ÙˆØ§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø¹ÙŠÙ†Ø© Ù„Ù‡Ù…</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</th>
                                <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                                <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
                            </tr>
                        </thead>
                        <tbody id="assignmentsTable">
                            <tr>
                                <td colspan="4" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <div class="modal-header">
                <h3>ØªØ¹Ø¯ÙŠÙ„ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</h3>
                <button class="modal-close" onclick="closeEditModal()">&times;</button>
            </div>
            <form id="editForm">
                <input type="hidden" id="editId">
                <input type="hidden" id="editLecturerId">
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ù…Ø­Ø§Ø¶Ø± (Ù„Ù„Ø§Ø·Ù„Ø§Ø¹ ÙÙ‚Ø·)</label>
                    <input type="text" class="form-control" id="editLecturerName" readonly disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ù…Ø§Ø¯Ø©</label>
                    <select class="form-control" id="editSubjectId" required>
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø©</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
                </button>
            </form>
        </div>
    </div>

    <script src="../js/api.js?v=2"></script>
    <script>
        checkAuth();

        let allAssignments = [];

        async function loadData() {
            // Setup Search for Lecturer
            setupSearchDropdown('lecturerSearch', 'lecturerResults', LecturersAPI.search, (id) => {
                document.getElementById('selectedLecturerId').value = id;
            });

            const subjects = await SubjectsAPI.getAll();
            if (subjects.success) {
                const select = document.getElementById('subjectId');
                const editSelect = document.getElementById('editSubjectId');
                subjects.data.forEach(s => {
                    const opt = `<option value="${s.subjectId}">${s.subjectName}</option>`;
                    select.innerHTML += opt;
                    editSelect.innerHTML += opt;
                });
            }

            loadAssignments();
        }

        async function loadAssignments() {
            const result = await apiCall('/lecturersubjects/GetAll');
            const tbody = document.getElementById('assignmentsTable');

            if (!result.success || result.data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹ÙŠÙŠÙ†Ø§Øª</td></tr>';
                return;
            }

            allAssignments = result.data;

            tbody.innerHTML = result.data.map((a, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td>${a.lecturer?.firstName || ''} ${a.lecturer?.lastName || ''}</td>
                    <td>${a.subject?.subjectName || ''}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="editAssignment(${a.lecturerSubjectId})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteAssignment(${a.lecturerSubjectId})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
        }

        function editAssignment(id) {
            const assignment = allAssignments.find(a => a.lecturerSubjectId === id);
            if (!assignment) return;

            document.getElementById('editId').value = assignment.lecturerSubjectId;
            document.getElementById('editLecturerId').value = assignment.lecturerId;
            document.getElementById('editLecturerName').value = `${assignment.lecturer?.firstName} ${assignment.lecturer?.lastName}`;
            document.getElementById('editSubjectId').value = assignment.subjectId;

            document.getElementById('editModal').classList.add('active');
        }

        async function deleteAssignment(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ¹ÙŠÙŠÙ†ØŸ')) {
                await apiCall(`/lecturersubjects/Delete/${id}`, 'DELETE');
                showAlert('ØªÙ… Ø­Ø°Ù Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­');
                loadAssignments();
            }
        }

        document.getElementById('assignForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const lecturerId = document.getElementById('selectedLecturerId').value;
            if (!lecturerId) {
                showAlert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ù…Ù† Ø§Ù„Ø¨Ø­Ø«', 'danger');
                return;
            }

            const result = await apiCall('/lecturersubjects/Add', 'POST', {
                lecturerId: parseInt(lecturerId),
                subjectId: parseInt(document.getElementById('subjectId').value)
            });
            if (result.success) {
                showAlert('ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­');
                loadAssignments();
            } else {
                showAlert(result.data.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£', 'danger');
            }
        });

        document.getElementById('editForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const id = document.getElementById('editId').value;
            const lecturerId = document.getElementById('editLecturerId').value;
            const subjectId = document.getElementById('editSubjectId').value;

            const result = await apiCall(`/lecturersubjects/Update/${id}`, 'PUT', {
                lecturerSubjectId: parseInt(id),
                lecturerId: parseInt(lecturerId),
                subjectId: parseInt(subjectId)
            });

            if (result.success) {
                showAlert('ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­');
                closeEditModal();
                loadAssignments();
            } else {
                showAlert(result.data.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£', 'danger');
            }
        });

        loadData();
    </script>
</body>

</html>



================
File: assign-students.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .search-results {
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .search-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }

        .search-item:hover {
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="dashboard.html" class="nav-link"><i class="fas fa-home"></i><span>Ù„ÙˆØ­Ø©
                            Ø§Ù„ØªØ­ÙƒÙ…</span></a></li>
                <li class="nav-item"><a href="students.html" class="nav-link"><i
                            class="fas fa-user-graduate"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</span></a></li>
                <li class="nav-item"><a href="lecturers.html" class="nav-link"><i
                            class="fas fa-chalkboard-teacher"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span></a></li>
                <li class="nav-item"><a href="subjects.html" class="nav-link"><i class="fas fa-book"></i><span>Ø¥Ø¯Ø§Ø±Ø©
                            Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="questions.html" class="nav-link"><i
                            class="fas fa-question-circle"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span></a></li>
                <li class="nav-item"><a href="assign-students.html" class="nav-link active"><i
                            class="fas fa-link"></i><span>Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="assign-lecturers.html" class="nav-link"><i
                            class="fas fa-link"></i><span>Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="reports.html" class="nav-link"><i
                            class="fas fa-chart-bar"></i><span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯ ÙˆØ§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</h2>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨ ÙÙŠ Ù…Ø§Ø¯Ø© Ù…Ø¹ Ù…Ø­Ø§Ø¶Ø± Ù…Ø­Ø¯Ø¯</h3>
                </div>
                <form id="assignForm">
                    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                        <div class="form-group" style="flex: 1; position: relative;">
                            <label class="form-label">Ø§Ù„Ø®Ø¸ÙˆØ© 1: Ø§Ø¨Ø­Ø« ÙˆØ§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                            <input type="hidden" id="selectedStudentId">
                            <input type="text" class="form-control" id="studentSearch"
                                placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ù„Ù„Ø¨Ø­Ø«..." autocomplete="off">
                            <div id="studentResults" class="search-results"></div>
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label class="form-label">Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø©</label>
                            <select class="form-control" id="subjectId" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø©</option>
                            </select>
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label class="form-label">Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</label>
                            <select class="form-control" id="lecturerId" required disabled>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø© Ø£ÙˆÙ„Ø§Ù‹</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Ø±Ø¨Ø· Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ù…Ø§Ø¯Ø© ÙˆØ§Ù„Ù…Ø­Ø§Ø¶Ø±
                    </button>
                </form>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¯</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                                <th>Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</th>
                                <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
                            </tr>
                        </thead>
                        <tbody id="assignmentsTable">
                            <tr>
                                <td colspan="5" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <div class="modal-header">
                <h3>ØªØ¹Ø¯ÙŠÙ„ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø·Ø§Ù„Ø¨</h3>
                <button class="modal-close" onclick="closeEditModal()">&times;</button>
            </div>
            <form id="editForm">
                <input type="hidden" id="editId">
                <input type="hidden" id="editStudentId">
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø·Ø§Ù„Ø¨ (Ù„Ù„Ø§Ø·Ù„Ø§Ø¹ ÙÙ‚Ø·)</label>
                    <input type="text" class="form-control" id="editStudentName" readonly disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ù…Ø§Ø¯Ø©</label>
                    <select class="form-control" id="editSubjectId" required>
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø©</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</label>
                    <select class="form-control" id="editLecturerId" required>
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
                </button>
            </form>
        </div>
    </div>

    <script src="../js/api.js?v=2"></script>
    <script>
        checkAuth();

        let allAssignments = [];

        async function loadData() {
            // Setup Search for Student
            setupSearchDropdown('studentSearch', 'studentResults', StudentsAPI.search, (id) => {
                document.getElementById('selectedStudentId').value = id;
            });

            const subjects = await SubjectsAPI.getAll();
            if (subjects.success) {
                const select = document.getElementById('subjectId');
                const editSelect = document.getElementById('editSubjectId');
                subjects.data.forEach(s => {
                    const opt = `<option value="${s.subjectId}">${s.subjectName}</option>`;
                    select.innerHTML += opt;
                    editSelect.innerHTML += opt;
                });
            }

            loadAssignments();
        }

        // Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø§Ø¯Ø© (Form Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ)
        document.getElementById('subjectId').addEventListener('change', async function () {
            await loadLecturersForSubject(this.value, 'lecturerId');
        });

        // Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø§Ø¯Ø© (Form Ø§Ù„ØªØ¹Ø¯ÙŠÙ„)
        document.getElementById('editSubjectId').addEventListener('change', async function () {
            await loadLecturersForSubject(this.value, 'editLecturerId');
        });

        async function loadLecturersForSubject(subjectId, targetSelectId) {
            const lecturerSelect = document.getElementById(targetSelectId);

            if (!subjectId) {
                lecturerSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø© Ø£ÙˆÙ„Ø§Ù‹</option>';
                lecturerSelect.disabled = true;
                return;
            }

            const lecturers = await apiCall(`/lecturersubjects/GetBySubject/${subjectId}`);
            lecturerSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</option>';

            if (lecturers.success && lecturers.data.length > 0) {
                lecturers.data.forEach(ls => {
                    lecturerSelect.innerHTML += `<option value="${ls.lecturerId}">${ls.lecturer?.firstName || ''} ${ls.lecturer?.lastName || ''}</option>`;
                });
                lecturerSelect.disabled = false;
            } else {
                lecturerSelect.innerHTML = '<option value="">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø©</option>';
                lecturerSelect.disabled = true;
            }
        }

        async function loadAssignments() {
            const result = await apiCall('/studentsubjects/GetAll');
            const tbody = document.getElementById('assignmentsTable');

            if (!result.success || result.data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹ÙŠÙŠÙ†Ø§Øª</td></tr>';
                return;
            }

            allAssignments = result.data;

            tbody.innerHTML = result.data.map((a, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td>${a.student?.firstName || ''} ${a.student?.lastName || ''}</td>
                    <td>${a.subject?.subjectName || ''}</td>
                    <td>${a.lecturer ? (a.lecturer.firstName + ' ' + a.lecturer.lastName) : '<span style="color:red">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</span>'}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="editAssignment(${a.studentSubjectId})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteAssignment(${a.studentSubjectId})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
        }

        async function editAssignment(id) {
            const assignment = allAssignments.find(a => a.studentSubjectId === id);
            if (!assignment) return;

            document.getElementById('editId').value = assignment.studentSubjectId;
            document.getElementById('editStudentId').value = assignment.studentId;
            document.getElementById('editStudentName').value = `${assignment.student?.firstName} ${assignment.student?.lastName}`;

            // Set Subject
            document.getElementById('editSubjectId').value = assignment.subjectId;

            // Load lecturers then set lecturer
            await loadLecturersForSubject(assignment.subjectId, 'editLecturerId');

            if (assignment.lecturerId) {
                document.getElementById('editLecturerId').value = assignment.lecturerId;
            }

            document.getElementById('editModal').classList.add('active');
        }

        async function deleteAssignment(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ¹ÙŠÙŠÙ†ØŸ')) {
                await apiCall(`/studentsubjects/Delete/${id}`, 'DELETE');
                showAlert('ØªÙ… Ø­Ø°Ù Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­');
                loadAssignments();
            }
        }

        document.getElementById('assignForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const lecturerId = document.getElementById('lecturerId').value;
            const studentId = document.getElementById('selectedStudentId').value;

            if (!lecturerId || !studentId) {
                showAlert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø·Ø§Ù„Ø¨ ÙˆØ§Ù„Ù…Ø­Ø§Ø¶Ø±', 'danger');
                return;
            }

            const result = await apiCall('/studentsubjects/Add', 'POST', {
                studentId: parseInt(studentId),
                subjectId: parseInt(document.getElementById('subjectId').value),
                lecturerId: parseInt(lecturerId)
            });

            if (result.success) {
                showAlert('ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ù…Ø§Ø¯Ø© ÙˆØ§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ù†Ø¬Ø§Ø­');
                loadAssignments();
            } else {
                showAlert(result.data.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£', 'danger');
            }
        });

        document.getElementById('editForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const id = document.getElementById('editId').value;
            const studentId = document.getElementById('editStudentId').value;
            const subjectId = document.getElementById('editSubjectId').value;
            const lecturerId = document.getElementById('editLecturerId').value;

            if (!lecturerId || !subjectId) {
                showAlert('Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©', 'danger');
                return;
            }

            // Call Update API
            const result = await apiCall(`/studentsubjects/Update/${id}`, 'PUT', {
                studentSubjectId: parseInt(id),
                studentId: parseInt(studentId),
                subjectId: parseInt(subjectId),
                lecturerId: parseInt(lecturerId)
            });

            if (result.success) {
                showAlert('ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­');
                closeEditModal();
                loadAssignments();
            } else {
                showAlert(result.data.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£', 'danger');
            }
        });

        loadData();
    </script>
</body>

</html>



================
File: dashboard.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="dashboard.html" class="nav-link active">
                        <i class="fas fa-home"></i>
                        <span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="students.html" class="nav-link">
                        <i class="fas fa-user-graduate"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="lecturers.html" class="nav-link">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="subjects.html" class="nav-link">
                        <i class="fas fa-book"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="questions.html" class="nav-link">
                        <i class="fas fa-question-circle"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="assign-students.html" class="nav-link">
                        <i class="fas fa-user-plus"></i>
                        <span>Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="assign-lecturers.html" class="nav-link">
                        <i class="fas fa-chalkboard-user"></i>
                        <span>Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="reports.html" class="nav-link">
                        <i class="fas fa-chart-bar"></i>
                        <span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
                    </a>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
                <span id="welcomeMessage">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ</span>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="studentsCount">0</div>
                    <div class="stat-label">Ø§Ù„Ø·Ù„Ø§Ø¨</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-number" id="lecturersCount">0</div>
                    <div class="stat-label">Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</div>
                </div>
                <div class="stat-card orange">
                    <div class="stat-number" id="subjectsCount">0</div>
                    <div class="stat-label">Ø§Ù„Ù…ÙˆØ§Ø¯</div>
                </div>
                <div class="stat-card red">
                    <div class="stat-number" id="evaluationsCount">0</div>
                    <div class="stat-label">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div>
                </div>
            </div>

            <!-- Actions -->
            <div class="card" style="margin-top: 20px;">
                <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <h3 class="card-title">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                </div>
                <div style="padding: 20px;">
                    <button onclick="resetEvaluations()" class="btn btn-danger">
                        <i class="fas fa-redo-alt"></i> Ø¨Ø¯Ø¡ Ø¯ÙˆØ±Ø© ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯Ø© (Ø£Ø±Ø´ÙØ© Ø§Ù„Ø­Ø§Ù„ÙŠ)
                    </button>
                </div>
            </div>

            <!-- Recent Evaluations -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ø¢Ø®Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</th>
                                <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                                <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                            </tr>
                        </thead>
                        <tbody id="recentEvaluations">
                            <tr>
                                <td colspan="4" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/api.js"></script>
    <script>
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        checkAuth();

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        async function loadStats() {
            // Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨
            const students = await StudentsAPI.getAll();
            if (students.success) {
                document.getElementById('studentsCount').textContent = students.data.length;
            }

            // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†
            const lecturers = await LecturersAPI.getAll();
            if (lecturers.success) {
                document.getElementById('lecturersCount').textContent = lecturers.data.length;
            }

            // Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯
            const subjects = await SubjectsAPI.getAll();
            if (subjects.success) {
                document.getElementById('subjectsCount').textContent = subjects.data.length;
            }

            // Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
            const evaluations = await EvaluationsAPI.getAll();
            if (evaluations.success) {
                document.getElementById('evaluationsCount').textContent = evaluations.data.length;
                loadRecentEvaluations(evaluations.data);
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
        function loadRecentEvaluations(evaluations) {
            const tbody = document.getElementById('recentEvaluations');

            if (evaluations.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª</td></tr>';
                return;
            }

            const recent = evaluations.slice(-5).reverse();
            tbody.innerHTML = recent.map((e, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td>${e.lecturerName || ''}</td>
                    <td>${e.subjectName || ''}</td>
                    <td>${'â˜…'.repeat(e.rating)}${'â˜†'.repeat(5 - e.rating)}</td>
                </tr>
            `).join('');
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        async function resetEvaluations() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¨Ø¯Ø¡ Ø¯ÙˆØ±Ø© ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯Ø©ØŸ Ø³ÙŠØªÙ… Ø£Ø±Ø´ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙˆÙ„Ù† ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©.')) {
                const result = await apiCall('/evaluations/Reset', 'POST');
                if (result.success) {
                    showAlert(result.data.message);
                } else {
                    showAlert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·', 'danger');
                }
            }
        }

        loadStats();
    </script>
</body>

</html>



================
File: evaluate.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="student-dashboard.html" class="nav-link"><i
                            class="fas fa-home"></i><span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></a></li>
                <li class="nav-item"><a href="evaluate.html" class="nav-link active"><i
                            class="fas fa-star"></i><span>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span></a></li>
                <li class="nav-item"><a href="view-ratings.html" class="nav-link"><i class="fas fa-eye"></i><span>Ø¹Ø±Ø¶
                            Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</h2>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h3>
                </div>

                <form id="evaluationForm">
                    <div class="form-group">
                        <label class="form-label">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø© Ù„ØªÙ‚ÙŠÙŠÙ… Ù…Ø­Ø§Ø¶Ø±Ù‡Ø§</label>
                        <select class="form-control" id="subjectSelect" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø©</option>
                        </select>
                    </div>

                    <div id="lecturerInfo"
                        style="display: none; background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="margin: 0;">Ø§Ù„Ù…Ø­Ø§Ø¶Ø±: <span id="lecturerName"
                                style="color: var(--primary-color);"></span></h4>
                        <input type="hidden" id="lecturerId">
                        <input type="hidden" id="subjectId">
                    </div>

                    <div id="questionsContainer" style="display: none;">
                        <!-- Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                    </div>

                    <button type="submit" id="submitBtn" class="btn btn-primary"
                        style="width: 100%; margin-top: 20px; display: none;">
                        <i class="fas fa-paper-plane"></i>
                        Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
                    </button>
                </form>
            </div>
        </main>
    </div>

    <script src="../js/api.js"></script>
    <script>
        checkAuth();

        const studentId = localStorage.getItem('userId');
        let questions = [];
        let studentSubjects = [];

        async function loadData() {
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù„ ÙÙŠÙ‡Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ø¹ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†
            const mySubjects = await apiCall(`/studentsubjects/GetByStudent/${studentId}`);
            const subjectSelect = document.getElementById('subjectSelect');

            if (mySubjects.success && mySubjects.data.length > 0) {
                studentSubjects = mySubjects.data;

                // ÙÙ„ØªØ± Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù„ÙŠ Ù…Ù„Ù‡Ø§Ø´ Ù…Ø­Ø§Ø¶Ø± (Ù„Ùˆ ÙÙŠÙ‡ Ø®Ø·Ø£ Ù‚Ø¯ÙŠÙ…)
                const validSubjects = studentSubjects.filter(ss => ss.lecturerId != null);

                if (validSubjects.length === 0) {
                    subjectSelect.innerHTML = '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¯ Ù…Ø³Ø¬Ù„Ø© Ù…Ø¹ Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† - ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø£Ø¯Ù…Ù†</option>';
                } else {
                    validSubjects.forEach(ss => {
                        subjectSelect.innerHTML += `<option value="${ss.studentSubjectId}">${ss.subject?.subjectName || 'Ù…Ø§Ø¯Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…'} (Ø¯. ${ss.lecturer?.lastName || ''})</option>`;
                    });
                }
            } else {
                subjectSelect.innerHTML = '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¯ Ù…Ø³Ø¬Ù„Ø© - ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø£Ø¯Ù…Ù†</option>';
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
            const questionsResult = await QuestionsAPI.getAll();
            if (questionsResult.success) {
                questions = questionsResult.data;
            }
        }

        // Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø§Ø¯Ø©
        document.getElementById('subjectSelect').addEventListener('change', function () {
            const studentSubjectId = this.value;
            const container = document.getElementById('questionsContainer');
            const submitBtn = document.getElementById('submitBtn');
            const lecturerInfo = document.getElementById('lecturerInfo');

            if (!studentSubjectId) {
                container.style.display = 'none';
                submitBtn.style.display = 'none';
                lecturerInfo.style.display = 'none';
                return;
            }

            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø© ÙˆØ§Ù„Ù…Ø­Ø§Ø¶Ø± Ø§Ù„Ù…Ø®ØªØ§Ø±
            const selected = studentSubjects.find(ss => ss.studentSubjectId == studentSubjectId);

            if (selected && selected.lecturer) {
                document.getElementById('lecturerName').textContent = selected.lecturer.firstName + ' ' + selected.lecturer.lastName;
                document.getElementById('lecturerId').value = selected.lecturerId;
                document.getElementById('subjectId').value = selected.subjectId;

                lecturerInfo.style.display = 'block';
                renderQuestions();
                container.style.display = 'block';
                submitBtn.style.display = 'block';
            }
        });

        function renderQuestions() {
            const container = document.getElementById('questionsContainer');
            if (questions.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: gray;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© - ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø£Ø¯Ù…Ù†</p>';
                return;
            }

            container.innerHTML = questions.map((q, i) => `
                <div class="card" style="margin-top: 15px;">
                    <p style="margin-bottom: 15px; font-weight: 500;">${i + 1}. ${q.questionText}</p>
                    <div class="rating" data-question="${q.questionId}">
                        ${[1, 2, 3, 4, 5].map(n => `<span class="star" data-value="${n}">â˜…</span>`).join('')}
                    </div>
                    <input type="hidden" name="rating_${q.questionId}" value="0">
                </div>
            `).join('');

            // Ø¥Ø¶Ø§ÙØ© events Ù„Ù„Ù†Ø¬ÙˆÙ…
            document.querySelectorAll('.rating').forEach(rating => {
                rating.querySelectorAll('.star').forEach(star => {
                    star.addEventListener('click', function () {
                        const value = this.dataset.value;
                        const questionId = this.parentElement.dataset.question;
                        document.querySelector(`input[name="rating_${questionId}"]`).value = value;

                        this.parentElement.querySelectorAll('.star').forEach((s, i) => {
                            s.classList.toggle('active', i < value);
                        });
                    });
                });
            });
        }

        document.getElementById('evaluationForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const lecturerId = document.getElementById('lecturerId').value;
            const subjectId = document.getElementById('subjectId').value;

            if (!lecturerId || !subjectId) {
                showAlert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±', 'danger');
                return;
            }

            let hasRating = false;
            let errorCount = 0;

            for (const q of questions) {
                const rating = document.querySelector(`input[name="rating_${q.questionId}"]`).value;
                if (rating > 0) {
                    hasRating = true;
                    const res = await EvaluationsAPI.add({
                        rating: parseInt(rating),
                        studentId: parseInt(studentId),
                        questionId: q.questionId,
                        lecturerId: parseInt(lecturerId),
                        subjectId: parseInt(subjectId)
                    });

                    if (!res.success) {
                        errorCount++;
                    }
                }
            }

            if (!hasRating) {
                showAlert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªÙ‚ÙŠÙŠÙ… Ø³Ø¤Ø§Ù„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'danger');
                return;
            }

            if (errorCount === 0) {
                showAlert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­! Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ.');
                setTimeout(() => window.location.reload(), 2000);
            } else {
                showAlert(`ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©. (Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ØªÙ… ØªÙ‚ÙŠÙŠÙ…Ù‡Ø§ Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŒ Ù„Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªÙƒØ±Ø§Ø±Ù‡Ø§)`, 'info');
                setTimeout(() => window.location.reload(), 3000);
            }
        });

        loadData();
    </script>
</body>

</html>



================
File: lecturer-dashboard.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙŠ</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="lecturer-dashboard.html" class="nav-link active"><i
                            class="fas fa-chart-line"></i><span>ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙŠ</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙŠ</h2>
            </div>

            <!-- Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalEvaluations">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-number" id="averageRating">0</div>
                    <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</div>
                </div>
            </div>

            <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª (Ø¨Ø¯ÙˆÙ† Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø·Ù„Ø§Ø¨)</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                                <th>Ø§Ù„Ø³Ø¤Ø§Ù„</th>
                                <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                            </tr>
                        </thead>
                        <tbody id="evaluationsTable">
                            <tr>
                                <td colspan="4" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/api.js"></script>
    <script>
        checkAuth();

        const lecturerId = localStorage.getItem('userId');

        async function loadMyEvaluations() {
            // Ø¬Ù„Ø¨ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ
            const result = await apiCall(`/evaluations/GetByLecturer/${lecturerId}`);

            if (!result.success || result.data.length === 0) {
                document.getElementById('evaluationsTable').innerHTML =
                    '<tr><td colspan="4" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯</td></tr>';
                return;
            }

            const evaluations = result.data;

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            document.getElementById('totalEvaluations').textContent = evaluations.length;
            const avg = evaluations.reduce((sum, e) => sum + e.rating, 0) / evaluations.length;
            document.getElementById('averageRating').textContent = avg.toFixed(1) + ' / 5';

            // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª (Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨)
            document.getElementById('evaluationsTable').innerHTML = evaluations.map((e, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td>${e.subjectName || '-'}</td>
                    <td>${e.questionText || '-'}</td>
                    <td>${'â˜…'.repeat(e.rating)}${'â˜†'.repeat(5 - e.rating)}</td>
                </tr>
            `).join('');
        }

        loadMyEvaluations();
    </script>
</body>

</html>



================
File: lecturers.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-item"><a href="dashboard.html" class="nav-link"><i class="fas fa-home"></i><span>Ù„ÙˆØ­Ø©
                            Ø§Ù„ØªØ­ÙƒÙ…</span></a></li>
                <li class="nav-item"><a href="students.html" class="nav-link"><i
                            class="fas fa-user-graduate"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</span></a></li>
                <li class="nav-item"><a href="lecturers.html" class="nav-link active"><i
                            class="fas fa-chalkboard-teacher"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span></a></li>
                <li class="nav-item"><a href="subjects.html" class="nav-link"><i class="fas fa-book"></i><span>Ø¥Ø¯Ø§Ø±Ø©
                            Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="questions.html" class="nav-link"><i
                            class="fas fa-question-circle"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span></a></li>
                <li class="nav-item"><a href="assign-students.html" class="nav-link"><i
                            class="fas fa-user-plus"></i><span>Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="assign-lecturers.html" class="nav-link"><i
                            class="fas fa-chalkboard-user"></i><span>Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="reports.html" class="nav-link"><i
                            class="fas fa-chart-bar"></i><span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">


            <div class="page-header">
                <h2 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</h2>
                <button class="btn btn-primary" onclick="openModal()">
                    <i class="fas fa-plus"></i>
                    Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø§Ø¶Ø±
                </button>
            </div>




            <!-- Search Bar -->
            <div class="card" style="margin-bottom: 20px;">
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="searchInput" class="form-control"
                        placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…..." onkeyup="searchLecturers()">
                </div>
            </div>

            <div class="card">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</th>
                                <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±</th>
                                <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="lecturersTable">
                            <tr>
                                <td colspan="5" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="lecturerModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø§Ø¶Ø± Ø¬Ø¯ÙŠØ¯</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="lecturerForm">
                <input type="hidden" id="lecturerId">
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</label>
                    <input type="text" class="form-control" id="firstName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±</label>
                    <input type="text" class="form-control" id="lastName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                    <input type="text" class="form-control" id="username" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" class="form-control" id="password" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <i class="fas fa-save"></i> Ø­ÙØ¸
                </button>
            </form>
        </div>
    </div>

    <script src="../js/api.js?v=2"></script>
    <script>
        checkAuth();

        let searchTimeout;
        function searchLecturers() {
            const query = document.getElementById('searchInput').value;
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => loadLecturers(query), 300);
        }

        async function loadLecturers(query = '') {
            const result = query ? await LecturersAPI.search(query) : await LecturersAPI.getAll();
            const tbody = document.getElementById('lecturersTable');

            if (!result.success || result.data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</td></tr>';
                return;
            }

            tbody.innerHTML = result.data.map((l, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td>${l.firstName}</td>
                    <td>${l.lastName}</td>
                    <td>${l.username}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="editLecturer(${l.lecturerId})"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-danger btn-sm" onclick="deleteLecturer(${l.lecturerId})"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>
            `).join('');
        }

        function openModal() {
            document.getElementById('lecturerModal').classList.add('active');
            document.getElementById('modalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø§Ø¶Ø± Ø¬Ø¯ÙŠØ¯';
            document.getElementById('lecturerForm').reset();
            document.getElementById('lecturerId').value = '';
        }

        function closeModal() {
            document.getElementById('lecturerModal').classList.remove('active');
        }

        async function editLecturer(id) {
            const result = await LecturersAPI.getById(id);
            if (result.success) {
                document.getElementById('lecturerId').value = result.data.lecturerId;
                document.getElementById('firstName').value = result.data.firstName;
                document.getElementById('lastName').value = result.data.lastName;
                document.getElementById('username').value = result.data.username;
                document.getElementById('password').value = result.data.password;
                document.getElementById('modalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±';
                document.getElementById('lecturerModal').classList.add('active');
            }
        }

        async function deleteLecturer(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ØŸ')) {
                const result = await LecturersAPI.delete(id);
                if (result.success) {
                    showAlert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ù†Ø¬Ø§Ø­');
                    loadLecturers();
                }
            }
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function validateLecturerData(data) {
            const errors = [];
            if (data.firstName.length < 2) errors.push('Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø­Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
            if (data.lastName.length < 2) errors.push('Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø­Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
            if (data.username.length < 3) errors.push('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
            if (!/^[a-zA-Z0-9_]+$/.test(data.username)) errors.push('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø­Ø±Ù Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙˆØ£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·');
            if (data.password.length < 4) errors.push('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
            return errors;
        }

        document.getElementById('lecturerForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const data = {
                firstName: document.getElementById('firstName').value.trim(),
                lastName: document.getElementById('lastName').value.trim(),
                username: document.getElementById('username').value.trim(),
                password: document.getElementById('password').value,
                adminId: 1
            };

            // Validation Check
            const errors = validateLecturerData(data);
            if (errors.length > 0) {
                showAlert(errors.join('\n'), 'danger');
                return;
            }

            const lecturerId = document.getElementById('lecturerId').value;
            const result = lecturerId ? await LecturersAPI.update(lecturerId, data) : await LecturersAPI.add(data);
            if (result.success) {
                showAlert(lecturerId ? 'ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ù†Ø¬Ø§Ø­' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­Ø§Ø¶Ø± Ø¨Ù†Ø¬Ø§Ø­');
                closeModal();
                loadLecturers();
            } else {
                // Show backend error
                showAlert(result.data.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£', 'danger');
            }
        });

        loadLecturers();
    </script>
</body>

</html>



================
File: questions.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="dashboard.html" class="nav-link"><i class="fas fa-home"></i><span>Ù„ÙˆØ­Ø©
                            Ø§Ù„ØªØ­ÙƒÙ…</span></a></li>
                <li class="nav-item"><a href="students.html" class="nav-link"><i
                            class="fas fa-user-graduate"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</span></a></li>
                <li class="nav-item"><a href="lecturers.html" class="nav-link"><i
                            class="fas fa-chalkboard-teacher"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span></a></li>
                <li class="nav-item"><a href="subjects.html" class="nav-link"><i class="fas fa-book"></i><span>Ø¥Ø¯Ø§Ø±Ø©
                            Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="questions.html" class="nav-link active"><i
                            class="fas fa-question-circle"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span></a></li>
                <li class="nav-item"><a href="assign-students.html" class="nav-link"><i
                            class="fas fa-user-plus"></i><span>Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="assign-lecturers.html" class="nav-link"><i
                            class="fas fa-chalkboard-user"></i><span>Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="reports.html" class="nav-link"><i
                            class="fas fa-chart-bar"></i><span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h2>
                <button class="btn btn-primary" onclick="openModal()"><i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„</button>
            </div>

            <div class="card">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="questionsTable">
                            <tr>
                                <td colspan="3" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <div class="modal-overlay" id="questionModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="questionForm">
                <input type="hidden" id="questionId">
                <div class="form-group">
                    <label class="form-label">Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„</label>
                    <textarea class="form-control" id="questionText" rows="3" required
                        placeholder="Ù…Ø«Ø§Ù„: ÙƒÙŠÙ ØªÙ‚ÙŠÙ… Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ØŸ"></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;"><i class="fas fa-save"></i>
                    Ø­ÙØ¸</button>
            </form>
        </div>
    </div>

    <script src="../js/api.js"></script>
    <script>
        checkAuth();

        let allQuestions = [];

        async function loadQuestions() {
            const result = await QuestionsAPI.getAll();
            const tbody = document.getElementById('questionsTable');
            if (!result.success || result.data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø©</td></tr>';
                return;
            }
            allQuestions = result.data;
            tbody.innerHTML = result.data.map((q, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td>${q.questionText}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="editQuestion(${q.questionId})"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-danger btn-sm" onclick="deleteQuestion(${q.questionId})"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>
            `).join('');
        }

        function openModal() {
            document.getElementById('questionModal').classList.add('active');
            document.getElementById('questionForm').reset();
            document.getElementById('questionId').value = '';
            document.querySelector('.modal-header h3').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯';
        }

        function closeModal() { document.getElementById('questionModal').classList.remove('active'); }

        function editQuestion(id) {
            const question = allQuestions.find(q => q.questionId === id);
            if (question) {
                document.getElementById('questionId').value = question.questionId;
                document.getElementById('questionText').value = question.questionText;
                document.querySelector('.modal-header h3').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„';
                document.getElementById('questionModal').classList.add('active');
            }
        }

        async function deleteQuestion(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„ØŸ')) {
                await QuestionsAPI.delete(id);
                showAlert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­');
                loadQuestions();
            }
        }

        document.getElementById('questionForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const id = document.getElementById('questionId').value;
            const text = document.getElementById('questionText').value;

            let result;
            if (id) {
                result = await QuestionsAPI.update(id, { questionText: text, adminId: 1, questionId: parseInt(id) });
            } else {
                result = await QuestionsAPI.add({ questionText: text, adminId: 1 });
            }

            if (result.success) {
                showAlert(id ? 'ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­');
                closeModal();
                loadQuestions();
            } else {
                showAlert('Ø­Ø¯Ø« Ø®Ø·Ø£', 'danger');
            }
        });

        loadQuestions();
    </script>
</body>

</html>



================
File: reports.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="dashboard.html" class="nav-link"><i class="fas fa-home"></i><span>Ù„ÙˆØ­Ø©
                            Ø§Ù„ØªØ­ÙƒÙ…</span></a></li>
                <li class="nav-item"><a href="students.html" class="nav-link"><i
                            class="fas fa-user-graduate"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</span></a></li>
                <li class="nav-item"><a href="lecturers.html" class="nav-link"><i
                            class="fas fa-chalkboard-teacher"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span></a></li>
                <li class="nav-item"><a href="subjects.html" class="nav-link"><i class="fas fa-book"></i><span>Ø¥Ø¯Ø§Ø±Ø©
                            Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="questions.html" class="nav-link"><i
                            class="fas fa-question-circle"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span></a></li>
                <li class="nav-item"><a href="assign-students.html" class="nav-link"><i
                            class="fas fa-user-plus"></i><span>Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="assign-lecturers.html" class="nav-link"><i
                            class="fas fa-chalkboard-user"></i><span>Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="reports.html" class="nav-link active"><i
                            class="fas fa-chart-bar"></i><span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</h2>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ù…Ù„Ø®Øµ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</th>
                                <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                                <th>Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                                <th>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="reportsTable">
                            <tr>
                                <td colspan="5" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- All Evaluations -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ÙƒÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                <th>Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</th>
                                <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                                <th>Ø§Ù„Ø³Ø¤Ø§Ù„</th>
                                <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                            </tr>
                        </thead>
                        <tbody id="allEvaluations">
                            <tr>
                                <td colspan="6" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/api.js"></script>
    <script>
        checkAuth();

        async function loadReports() {
            // ØªÙ‚Ø±ÙŠØ± Ù…Ù„Ø®Øµ
            const report = await EvaluationsAPI.getReport();
            const reportBody = document.getElementById('reportsTable');

            if (report.success && report.data.length > 0) {
                reportBody.innerHTML = report.data.map((r, i) => `
                    <tr>
                        <td>${i + 1}</td>
                        <td>${r.lecturerName}</td>
                        <td>${r.subjectName}</td>
                        <td>
                            <span style="color: ${r.averageRating >= 4 ? 'green' : r.averageRating >= 2.5 ? 'orange' : 'red'}; font-weight: bold;">
                                ${r.averageRating.toFixed(1)} / 5
                            </span>
                        </td>
                        <td>${r.totalEvaluations}</td>
                    </tr>
                `).join('');
            } else {
                reportBody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª</td></tr>';
            }

            // ÙƒÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
            const all = await EvaluationsAPI.getAll();
            const allBody = document.getElementById('allEvaluations');

            if (all.success && all.data.length > 0) {
                allBody.innerHTML = all.data.map((e, i) => `
                    <tr>
                        <td>${i + 1}</td>
                        <td>Ø·Ø§Ù„Ø¨</td>
                        <td>${e.lecturerName || ''}</td>
                        <td>${e.subjectName || ''}</td>
                        <td>${e.questionText || ''}</td>
                        <td>${'â˜…'.repeat(e.rating)}${'â˜†'.repeat(5 - e.rating)}</td>
                    </tr>
                `).join('');
            } else {
                allBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª</td></tr>';
            }
        }

        loadReports();
    </script>
</body>

</html>



================
File: student-dashboard.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ø§Ù„Ø·Ø§Ù„Ø¨</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="student-dashboard.html" class="nav-link active"><i
                            class="fas fa-home"></i><span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></a></li>
                <li class="nav-item"><a href="evaluate.html" class="nav-link"><i class="fas fa-star"></i><span>ØªÙ‚ÙŠÙŠÙ…
                            Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span></a></li>
                <li class="nav-item"><a href="view-ratings.html" class="nav-link"><i class="fas fa-eye"></i><span>Ø¹Ø±Ø¶
                            Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ</h2>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="myEvaluations">0</div>
                    <div class="stat-label">ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙŠ</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-number" id="totalLecturers">0</div>
                    <div class="stat-label">Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h3>
                </div>
                <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                    <a href="evaluate.html" class="btn btn-primary" style="text-decoration: none;">
                        <i class="fas fa-star"></i> ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†
                    </a>
                    <a href="view-ratings.html" class="btn btn-success" style="text-decoration: none;">
                        <i class="fas fa-eye"></i> Ø¹Ø±Ø¶ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†
                    </a>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/api.js"></script>
    <script>
        checkAuth();

        async function loadStats() {
            const lecturers = await LecturersAPI.getAll();
            if (lecturers.success) {
                document.getElementById('totalLecturers').textContent = lecturers.data.length;
            }

            const evaluations = await EvaluationsAPI.getAll();
            if (evaluations.success) {
                const studentId = localStorage.getItem('userId');
                const myEvals = evaluations.data.filter(e => e.studentId == studentId);
                document.getElementById('myEvaluations').textContent = myEvals.length;
            }
        }

        loadStats();
    </script>
</body>

</html>



================
File: students.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="dashboard.html" class="nav-link">
                        <i class="fas fa-home"></i>
                        <span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="students.html" class="nav-link active">
                        <i class="fas fa-user-graduate"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="lecturers.html" class="nav-link">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="subjects.html" class="nav-link">
                        <i class="fas fa-book"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="questions.html" class="nav-link">
                        <i class="fas fa-question-circle"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="assign-students.html" class="nav-link">
                        <i class="fas fa-user-plus"></i>
                        <span>Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="assign-lecturers.html" class="nav-link">
                        <i class="fas fa-chalkboard-user"></i>
                        <span>Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="reports.html" class="nav-link">
                        <i class="fas fa-chart-bar"></i>
                        <span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
                    </a>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">


            <div class="page-header">
                <h2 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</h2>
                <button class="btn btn-primary" onclick="openModal()">
                    <i class="fas fa-plus"></i>
                    Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨
                </button>
            </div>

            <!-- Search Bar -->
            <div class="card" style="margin-bottom: 20px;">
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="searchInput" class="form-control"
                        placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…..." onkeyup="searchStudents()">
                </div>
            </div>

            <!-- Students Table -->
            <div class="card">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</th>
                                <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±</th>
                                <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTable">
                            <tr>
                                <td colspan="5" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pagination Controls -->
                <div id="pagination"
                    style="padding: 15px; display: flex; justify-content: center; align-items: center; border-top: 1px solid #eee;">
                </div>
            </div>
        </main>
    </div>

    <!-- Add/Edit Modal -->
    <div class="modal-overlay" id="studentModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>

            <form id="studentForm">
                <input type="hidden" id="studentId">

                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</label>
                    <input type="text" class="form-control" id="firstName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±</label>
                    <input type="text" class="form-control" id="lastName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                    <input type="text" class="form-control" id="username" required>
                </div>

                <div class="form-group">
                    <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" class="form-control" id="password" required>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <i class="fas fa-save"></i>
                    Ø­ÙØ¸
                </button>
            </form>
        </div>
    </div>

    <script src="../js/api.js?v=2"></script>
    <script>
        checkAuth();

        let searchTimeout;
        function searchStudents() {
            const query = document.getElementById('searchInput').value;
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => loadStudents(query), 300);
        }

        let currentPage = 1;
        const pageSize = 20;

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨
        async function loadStudents(query = '', page = 1) {
            currentPage = page;
            const result = query ? await StudentsAPI.search(query) : await StudentsAPI.getAll(page, pageSize);
            const tbody = document.getElementById('studentsTable');
            const paginationDiv = document.getElementById('pagination');

            if (!result.success || (query ? result.data.length === 0 : result.data.items.length === 0)) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨</td></tr>';
                paginationDiv.innerHTML = '';
                return;
            }

            const data = query ? result.data : result.data.items;

            tbody.innerHTML = data.map((s, i) => `
                <tr>
                    <td>${(currentPage - 1) * pageSize + i + 1}</td>
                    <td>${s.firstName}</td>
                    <td>${s.lastName}</td>
                    <td>${s.username}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="editStudent(${s.studentId})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteStudent(${s.studentId})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');

            // Pagination Controls (Only show if not searching)
            if (!query) {
                const info = result.data;
                paginationDiv.innerHTML = `
                    <button class="btn btn-secondary btn-sm" ${!info.hasPrevious ? 'disabled' : ''} onclick="loadStudents('', ${currentPage - 1})">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                    <span style="margin: 0 10px;">ØµÙØ­Ø© ${info.currentPage} Ù…Ù† ${info.totalPages} (Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${info.totalCount})</span>
                    <button class="btn btn-secondary btn-sm" ${!info.hasNext ? 'disabled' : ''} onclick="loadStudents('', ${currentPage + 1})">Ø§Ù„ØªØ§Ù„ÙŠ</button>
                `;
            } else {
                paginationDiv.innerHTML = '';
            }
        }

        // ÙØªØ­ Ø§Ù„Ù€ Modal
        function openModal() {
            document.getElementById('studentModal').classList.add('active');
            document.getElementById('modalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯';
            document.getElementById('studentForm').reset();
            document.getElementById('studentId').value = '';
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù€ Modal
        function closeModal() {
            document.getElementById('studentModal').classList.remove('active');
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ø·Ø§Ù„Ø¨
        async function editStudent(id) {
            const result = await StudentsAPI.getById(id);
            if (result.success) {
                document.getElementById('studentId').value = result.data.studentId;
                document.getElementById('firstName').value = result.data.firstName;
                document.getElementById('lastName').value = result.data.lastName;
                document.getElementById('username').value = result.data.username;
                document.getElementById('password').value = result.data.password;
                document.getElementById('modalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨';
                document.getElementById('studentModal').classList.add('active');
            }
        }

        // Ø­Ø°Ù Ø·Ø§Ù„Ø¨
        async function deleteStudent(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ØŸ')) {
                const result = await StudentsAPI.delete(id);
                if (result.success) {
                    showAlert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
                    loadStudents();
                }
            }
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function validateStudentData(data) {
            const errors = [];
            if (data.firstName.length < 2) errors.push('Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø­Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
            if (data.lastName.length < 2) errors.push('Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø­Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
            if (data.username.length < 3) errors.push('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
            if (!/^[a-zA-Z0-9_]+$/.test(data.username)) errors.push('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø­Ø±Ù Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙˆØ£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·');
            if (data.password.length < 4) errors.push('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
            return errors;
        }

        // Ø­ÙØ¸ Ø§Ù„Ø·Ø§Ù„Ø¨
        document.getElementById('studentForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const data = {
                firstName: document.getElementById('firstName').value.trim(),
                lastName: document.getElementById('lastName').value.trim(),
                username: document.getElementById('username').value.trim(),
                password: document.getElementById('password').value,
                adminId: 1
            };

            // Validation Check
            const errors = validateStudentData(data);
            if (errors.length > 0) {
                showAlert(errors.join('\n'), 'danger');
                return;
            }

            const studentId = document.getElementById('studentId').value;
            let result;

            if (studentId) {
                result = await StudentsAPI.update(studentId, data);
            } else {
                result = await StudentsAPI.add(data);
            }

            if (result.success) {
                showAlert(studentId ? 'ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
                closeModal();
                loadStudents();
            } else {
                showAlert(result.data.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£', 'danger');
            }
        });

        loadStudents();
    </script>
</body>

</html>



================
File: subjects.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="dashboard.html" class="nav-link"><i class="fas fa-home"></i><span>Ù„ÙˆØ­Ø©
                            Ø§Ù„ØªØ­ÙƒÙ…</span></a></li>
                <li class="nav-item"><a href="students.html" class="nav-link"><i
                            class="fas fa-user-graduate"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</span></a></li>
                <li class="nav-item"><a href="lecturers.html" class="nav-link"><i
                            class="fas fa-chalkboard-teacher"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span></a></li>
                <li class="nav-item"><a href="subjects.html" class="nav-link active"><i
                            class="fas fa-book"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="questions.html" class="nav-link"><i
                            class="fas fa-question-circle"></i><span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span></a></li>
                <li class="nav-item"><a href="assign-students.html" class="nav-link"><i
                            class="fas fa-user-plus"></i><span>Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="assign-lecturers.html" class="nav-link"><i
                            class="fas fa-chalkboard-user"></i><span>Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ† Ø¨Ø§Ù„Ù…ÙˆØ§Ø¯</span></a></li>
                <li class="nav-item"><a href="reports.html" class="nav-link"><i
                            class="fas fa-chart-bar"></i><span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯</h2>
                <button class="btn btn-primary" onclick="openModal()"><i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø©</button>
            </div>

            <div class="card">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="subjectsTable">
                            <tr>
                                <td colspan="3" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <div class="modal-overlay" id="subjectModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="subjectForm">
                <input type="hidden" id="subjectId">
                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</label>
                    <input type="text" class="form-control" id="subjectName" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;"><i class="fas fa-save"></i>
                    Ø­ÙØ¸</button>
            </form>
        </div>
    </div>

    <script src="../js/api.js"></script>
    <script>
        checkAuth();

        async function loadSubjects() {
            const result = await SubjectsAPI.getAll();
            const tbody = document.getElementById('subjectsTable');
            if (!result.success || result.data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¯</td></tr>';
                return;
            }
            tbody.innerHTML = result.data.map((s, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td>${s.subjectName}</td>
                    <td>
                        <button class="btn btn-danger btn-sm" onclick="deleteSubject(${s.subjectId})"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>
            `).join('');
        }

        function openModal() { document.getElementById('subjectModal').classList.add('active'); }
        function closeModal() { document.getElementById('subjectModal').classList.remove('active'); }

        async function deleteSubject(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø©ØŸ')) {
                await SubjectsAPI.delete(id);
                showAlert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­');
                loadSubjects();
            }
        }

        document.getElementById('subjectForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const result = await SubjectsAPI.add({ subjectName: document.getElementById('subjectName').value });
            if (result.success) {
                showAlert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­');
                closeModal();
                document.getElementById('subjectForm').reset();
                loadSubjects();
            }
        });

        loadSubjects();
    </script>
</body>

</html>



================
File: view-ratings.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - Ø¹Ø±Ø¶ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="student-dashboard.html" class="nav-link"><i
                            class="fas fa-home"></i><span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></a></li>
                <li class="nav-item"><a href="evaluate.html" class="nav-link"><i class="fas fa-star"></i><span>ØªÙ‚ÙŠÙŠÙ…
                            Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</span></a></li>
                <li class="nav-item"><a href="view-ratings.html" class="nav-link active"><i
                            class="fas fa-eye"></i><span>Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</span></a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="logout()"><i
                            class="fas fa-sign-out-alt"></i><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h2 class="page-title">ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</h2>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ù…Ù„Ø®Øµ ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙƒÙ„ Ù…Ø­Ø§Ø¶Ø±</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</th>
                                <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                                <th>Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                                <th>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="ratingsTable">
                            <tr>
                                <td colspan="5" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/api.js"></script>
    <script>
        checkAuth();

        async function loadRatings() {
            const result = await EvaluationsAPI.getReport();
            const tbody = document.getElementById('ratingsTable');

            if (!result.success || result.data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯</td></tr>';
                return;
            }

            tbody.innerHTML = result.data.map((r, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td>${r.lecturerName}</td>
                    <td>${r.subjectName}</td>
                    <td>
                        <span style="color: ${r.averageRating >= 4 ? 'green' : r.averageRating >= 2.5 ? 'orange' : 'red'}; font-weight: bold;">
                            ${r.averageRating.toFixed(1)} / 5
                        </span>
                        <span style="color: gold;">${'â˜…'.repeat(Math.round(r.averageRating))}</span>
                    </td>
                    <td>${r.totalEvaluations}</td>
                </tr>
            `).join('');
        }

        loadRatings();
    </script>
</body>

</html>



================
File: index.html
================
<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="refresh" content="0; url=login.html">
    <title>ProfRate - Redirecting...</title>
</head>

<body>
    <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...</p>
</body>

</html>



================
File: login.html
================
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfRate - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="login-container">
        <div class="login-card">
            <div class="login-header">
                <h1><i class="fas fa-graduation-cap"></i> ProfRate</h1>
                <p>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±ÙŠÙ†</p>
            </div>

            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                    <input type="text" class="form-control" id="username" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
                </div>

                <div class="form-group">
                    <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" class="form-control" id="password" required placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                </div>

                <div class="form-group">
                    <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                    <select class="form-control" id="userType" required>
                        <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</option>
                        <option value="Admin">Ø£Ø¯Ù…Ù†</option>
                        <option value="Student">Ø·Ø§Ù„Ø¨</option>
                        <option value="Lecturer">Ù…Ø­Ø§Ø¶Ø±</option>
                    </select>
                </div>

                <div id="errorMessage" class="alert alert-danger" style="display: none;"></div>

                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i>
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                </button>
            </form>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script>
        document.getElementById('loginForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const userType = document.getElementById('userType').value;
            const errorDiv = document.getElementById('errorMessage');

            // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
            errorDiv.style.display = 'none';

            // Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            const result = await AuthAPI.login(username, password, userType);

            if (result.success && result.data.success) {
                // Ø­ÙØ¸ Ø§Ù„Ù€ Token
                localStorage.setItem('token', result.data.token);
                localStorage.setItem('userType', result.data.userType);
                localStorage.setItem('userId', result.data.userId);

                // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
                if (userType === 'Admin') {
                    window.location.href = 'pages/dashboard.html';
                } else if (userType === 'Student') {
                    window.location.href = 'pages/student-dashboard.html';
                } else {
                    window.location.href = 'pages/lecturer-dashboard.html';
                }
            } else {
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
                errorDiv.textContent = result.data.message || 'Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
                errorDiv.style.display = 'block';
            }
        });
    </script>
</body>

</html>



================
File: Program.cs
================
using Microsoft.AspNetCore.Authentication.JwtBearer;
using Microsoft.AspNetCore.RateLimiting;
using Microsoft.EntityFrameworkCore;
using Microsoft.IdentityModel.Tokens;
using ProfRate.Data;
using ProfRate.Services;
using System.Text;

var builder = WebApplication.CreateBuilder(args);

// ===== Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ Services =====

// 1. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ Controllers with JSON options
builder.Services.AddControllers()
    .AddJsonOptions(options =>
    {
        options.JsonSerializerOptions.ReferenceHandler = System.Text.Json.Serialization.ReferenceHandler.IgnoreCycles;
    });

// 2. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ Swagger
builder.Services.AddEndpointsApiExplorer();
builder.Services.AddSwaggerGen();

// 3. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ Database Connection
builder.Services.AddDbContext<AppDbContext>(options =>
    options.UseSqlServer(builder.Configuration.GetConnectionString("DefaultConnection")));

// 4. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ Services (Dependency Injection)
builder.Services.AddScoped<AuthService>();
builder.Services.AddScoped<StudentService>();
builder.Services.AddScoped<LecturerService>();
builder.Services.AddScoped<EvaluationService>();
builder.Services.AddScoped<QuestionService>();
builder.Services.AddScoped<SubjectService>();
builder.Services.AddScoped<StudentSubjectService>();
builder.Services.AddScoped<LecturerSubjectService>();

// 5. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ JWT Authentication
builder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)
    .AddJwtBearer(options =>
    {
        options.TokenValidationParameters = new TokenValidationParameters
        {
            ValidateIssuer = true,
            ValidateAudience = true,
            ValidateLifetime = true,
            ValidateIssuerSigningKey = true,
            ValidIssuer = builder.Configuration["Jwt:Issuer"],
            ValidAudience = builder.Configuration["Jwt:Audience"],
            IssuerSigningKey = new SymmetricSecurityKey(
                Encoding.UTF8.GetBytes(builder.Configuration["Jwt:Key"]!))
        };
    });

// 6. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ CORS (Ù„Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù€ Frontend Ø¨Ø§Ù„ØªÙˆØ§ØµÙ„)
// 6. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ CORS (Ù„Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù€ Frontend Ø¨Ø§Ù„ØªÙˆØ§ØµÙ„)
var allowedOrigins = builder.Configuration.GetSection("AllowedOrigins").Get<string[]>() ?? new[] { "*" };
builder.Services.AddCors(options =>
{
    options.AddPolicy("AllowSpecificOrigins", policy =>
    {
        if (allowedOrigins.Contains("*"))
        {
             policy.AllowAnyOrigin().AllowAnyMethod().AllowAnyHeader();
        }
        else 
        {
             policy.WithOrigins(allowedOrigins).AllowAnyMethod().AllowAnyHeader().AllowCredentials();
        }
    });
});

// 7. Ø¥Ø¶Ø§ÙØ© Memory Cache (Ù„Ù„Ø£Ø¯Ø§Ø¡)
builder.Services.AddMemoryCache();

// 8. Ø¥Ø¶Ø§ÙØ© Rate Limiting (Ù„Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ù‡Ø¬Ù…Ø§Øª)
builder.Services.AddRateLimiter(options =>
{
    // General Policy
    options.AddFixedWindowLimiter("general", opt =>
    {
        opt.PermitLimit = 30;
        opt.Window = TimeSpan.FromMinutes(1);
        opt.QueueProcessingOrder = System.Threading.RateLimiting.QueueProcessingOrder.OldestFirst;
        opt.QueueLimit = 2;
    });

    // Strict Login Policy
    options.AddFixedWindowLimiter("login", opt =>
    {
        opt.PermitLimit = 5;
        opt.Window = TimeSpan.FromMinutes(5);
        opt.QueueProcessingOrder = System.Threading.RateLimiting.QueueProcessingOrder.OldestFirst;
        opt.QueueLimit = 0;
    });
});

var app = builder.Build();

// ===== Configure the HTTP request pipeline =====

// ===== Configure the HTTP request pipeline =====
app.UseMiddleware<ProfRate.Middleware.ExceptionMiddleware>();

// Swagger (Ù„Ù„ØªØ·ÙˆÙŠØ± ÙÙ‚Ø·)
if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseSwaggerUI();
}

// Static Files - Ù„ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ù€ Frontend
app.UseDefaultFiles();
app.UseStaticFiles();

// HTTPS Redirection
app.UseHttpsRedirection();

// CORS
app.UseCors("AllowSpecificOrigins");

// Rate Limiter
app.UseRateLimiter();

// Authentication & Authorization
app.UseAuthentication();
app.UseAuthorization();

// Map Controllers
app.MapControllers();

// Redirect root to frontend
app.MapGet("/", () => Results.Redirect("/frontend/login.html"));

// ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
app.Run();



